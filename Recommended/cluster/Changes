diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/agnes.q Recommended/cluster/R/agnes.q
8a9
>    dataname <- sQuote(deparse(substitute(x)))
47c48
< 	if(anyNA(x)) stop("NA-values in the dissimilarity matrix not allowed.")
---
> 	if(anyNA(x)) stop("NA values in the dissimilarity matrix not allowed.")
54c55
< 		    stop("'x' is not and cannot be converted to class \"dissimilarity\"")
---
> 		    stop(gettextf("%s is not and cannot be converted to class \"dissimilarity\"", dataname))
72c73
< 	if(!is.numeric(x)) stop("x is not a numeric dataframe or matrix.")
---
> 	if(!is.numeric(x)) stop(gettextf("%s is not a numeric dataframe or matrix.", dataname))
112c113
< 	    stop("No clustering performed, NA-values in the dissimilarity matrix.\n" )
---
> 	    stop("No clustering performed, NA values in the dissimilarity matrix.", "\n", sep = "" )
155,157c156,158
<     cat("Call:	", deparse(x$call),
< 	"\nAgglomerative coefficient: ", format(x$ac, ...),
< 	"\nOrder of objects:\n")
---
> 	cat(gettext("Call: ", domain = "R-cluster"), deparse(x$call), "\n", sep = "")
> 	cat(gettext("Agglomerative coefficient: ", domain = "R-cluster"), format(x$ac, ...), "\n", sep = "")
> 	cat(gettext("Order of objects:", domain = "R-cluster"), "\n", sep = "")
160,161c161,162
<     cat("Height (summary):\n");		print(summary(x$height), ...)
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat(gettext("Height (summary):", domain = "R-cluster"), "\n", sep = "");		print(summary(x$height), ...)
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
168,170c169,171
<     cat("Object of class 'agnes' from call:\n", deparse(x$call),
< 	"\nAgglomerative coefficient: ", format(x$ac, ...),
< 	"\nOrder of objects:\n")
---
> 	cat(gettext("Object of class 'agnes' from call:", domain = "R-cluster"), "\n", deparse(x$call), "\n", sep = "")
> 	cat(gettext("Agglomerative coefficient: ", domain = "R-cluster"), format(x$ac, ...), "\n", sep = "")
> 	cat(gettext("Order of objects:", domain = "R-cluster"), "\n", sep = "")
173,174c174,175
<     cat("Merge:\n");			print(x$merge, ...)
<     cat("Height:\n");			print(x$height, ...)
---
>     cat(gettext("Merge:", domain = "R-cluster"), "\n", sep = "");			print(x$merge, ...)
>     cat(gettext("Height:", domain = "R-cluster"), "\n", sep = "");			print(x$height, ...)
178c179
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/clara.q Recommended/cluster/R/clara.q
9a10
>     dataname <- sQuote(deparse(substitute(x)))
12c13
< 	stop("'x' is a \"dist\" object, but should be a data matrix or frame")
---
> 	stop(gettextf("%s is a \"dist\" object, but should be a data matrix or frame", dataname))
14c15
<     if(!is.numeric(x)) stop("x is not a numeric dataframe or matrix.")
---
>     if(!is.numeric(x)) stop(gettextf("%s is not a numeric dataframe or matrix.", dataname))
19,20c20
< 	stop(gettextf("'sampsize' should be at least %d = max(2, 1+ number of clusters)",
<                       max(2,k+1)), domain=NA)
---
> 	stop(gettextf("'sampsize' should be at least %d = max(2, 1+ number of clusters)", max(2,k+1)), domain = "R-cluster")
22,23c22
< 	stop(gettextf("'sampsize' = %d should not be larger than the number of objects, %d",
<                       sampsize, n), domain=NA)
---
> 	stop(gettextf("'sampsize' = %d should not be larger than the number of objects, %d", sampsize, n), domain = "R-cluster")
93,96c92
< 		stop(sprintf(ngettext(nNA,
< 			      "Observation %s has *only* NAs --> omit it for clustering",
< 			      "Observations %s have *only* NAs --> omit them for clustering!"),
< 			     pasteC(i)), domain = NA)
---
> 	     stop(sprintf(ngettext(nNA, "Observation %s has *only* NAs --> omit it for clustering", "Observations %s have *only* NAs --> omit them for clustering!", domain = "R-cluster"), pasteC(i)), domain = NA)
98,101c94
< 		stop(sprintf(ngettext(nNA,
< 			      "%d observation (%s) has *only* NAs --> omit them for clustering!",
< 			      "%d observations (%s ...) have *only* NAs --> omit them for clustering!"),
< 			     nNA, pasteC(i[1:12])), domain = NA)
---
> 	     stop(sprintf(ngettext(nNA, "%d observation (%s) has *only* NAs --> omit them for clustering!", "%d observations (%s ...) have *only* NAs --> omit them for clustering!", domain = "R-cluster"), nNA, pasteC(i[1:12])), domain = NA)
108c101
< 	stop("invalid 'jstop' from .C(cl_clara,.): ", res$jstop)
---
> 	stop(gettextf("invalid 'jstop' from .C(cl_clara,.): %s", res$jstop))
111c104
<     res$clu <- as.integer(res$clu[1:n])
---
>     res$clu <- as.integer(res$clu[seq_len(n)])
149,155c142,148
<     cat("Call:	", deparse(x$call),
< 	"\nMedoids:\n");		print(x$medoids, ...)
<     cat("Objective function:\t ", format(x$objective, ...),"\n",
< 	"Clustering vector: \t", sep=""); str(x$clustering, vec.len = 7)
<     cat("Cluster sizes:	    \t", x$clusinfo[,1],
< 	"\nBest sample:\n");		print(x$sample, quote = FALSE, ...)
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat(gettext("Call: ", domain = "R-cluster"), deparse(x$call), "\n", sep = "")
> 	cat(gettext("Medoids:", domain = "R-cluster"), "\n", sep = "");		print(x$medoids, ...)
>     cat(gettext("Objective function:", domain = "R-cluster"), "\t", format(x$objective, ...), "\n", sep = "")
> 	cat(gettext("Clustering vector:", domain = "R-cluster"), "\t", sep = ""); str(x$clustering, vec.len = 7)
>     cat(gettext("Cluster sizes:", domain = "R-cluster"), "	    \t", x$clusinfo[,1], "\n", sep = "")
> 	cat(gettext("Best sample:", domain = "R-cluster"), "\n", sep = "");		print(x$sample, quote = FALSE, ...)
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
167,170c160,163
<     cat("Object of class 'clara' from call:\n", deparse(x$call),
< 	"\nMedoids:\n");		print(x$medoids, ...)
<     cat("Objective function:\t ", format(x$objective, ...),
< 	"\nNumerical information per cluster:\n")
---
>     cat(gettext("Object of class 'clara' from call:", domain = "R-cluster"), "\n", deparse(x$call), "\n", sep = "")
> 	cat(gettext("Medoids:", domain = "R-cluster"), "\n", sep = "");		print(x$medoids, ...)
>     cat(gettext("Objective function:", domain = "R-cluster"), "\t", format(x$objective, ...), "\n", sep = "")
> 	cat(gettext("Numerical information per cluster:", domain = "R-cluster"), "\n", sep = "")
173c166
< 	cat("Average silhouette width per cluster:\n")
---
> 	cat(gettext("Average silhouette width per cluster:", domain = "R-cluster"), "\n", sep = "")
175,176c168,169
< 	cat("Average silhouette width of best sample:",
< 	    format(x$silinfo[[3]], ...), "\n")
---
> 	cat(gettext("Average silhouette width of best sample: ", domain = "R-cluster"),
> 	    format(x$silinfo[[3]], ...), "\n", sep = "")
178,179c171,172
<     cat("\nBest sample:\n");		print(x$sample, quote = FALSE, ...)
<     cat("Clustering vector:\n");	print(x$clustering, ...)
---
>     cat("\n", gettext("Best sample:", domain = "R-cluster"), "\n");		print(x$sample, quote = FALSE, ...)
>     cat(gettext("Clustering vector:", domain = "R-cluster"), "\n");	print(x$clustering, ...)
181c174
< 	cat("\nSilhouette plot information for best sample:\n")
---
> 	cat("\n", gettext("Silhouette plot information for best sample:", domain = "R-cluster"), "\n")
187c180
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/clusGap.R Recommended/cluster/R/clusGap.R
33,34c33,34
<     if(verbose) cat("Clustering k = 1,2,..., K.max (= ",K.max,"): .. ", sep='')
<     for(k in 1:K.max)
---
>     if(verbose) cat(gettextf("Clustering k = 1,2,..., K.max (= %d): .. ", K.max, domain = "R-cluster"), sep = "")
>     for(k in seq_len(K.max))
36c36
<     if(verbose) cat("done\n")
---
>     if(verbose) cat(gettext("done", domain = "R-cluster"), "\n", sep = "")
46,48c46,47
<     if(verbose) cat("Bootstrapping, b = 1,2,..., B (= ", B,
<                     ")  [one \".\" per sample]:\n", sep="")
<     for (b in 1:B) {
---
>     if(verbose) cat(gettextf("Bootstrapping, b = 1,2,..., B (= %d)  [one \".\" per sample]:", B, domain = "R-cluster"), "\n", sep = "")
>     for (b in seq_len(B)) {
54c53
<         for(k in 1:K.max) {
---
>         for(k in seq_len(K.max)) {
128,129c127,128
<     cat("Clustering Gap statistic [\"clusGap\"].\n",
<         sprintf("B=%d simulated reference sets, k = 1..%d\n",x$B, K), sep="")
---
>     cat(gettext("Clustering Gap statistic [\"clusGap\"].", domain = "R-cluster"), "\n",
>         gettextf("B=%d simulated reference sets, k = 1..%d", x$B, K, domain = "R-cluster"), "\n", sep = "")
132,134c131,134
<     cat(sprintf(" --> Number of clusters (method '%s'%s): %d\n",
< 		method, if(grepl("SE", method))
< 		sprintf(", SE.factor=%g",SE.factor) else "", nc))
---
> 	if(grepl("SE", method))
>     cat(gettextf(" --> Number of clusters (method '%s', SE.factor=%g): %d", method, SE.factor, nc, domain = "R-cluster"), "\n", sep = "")
> 	else
> 	cat(gettextf(" --> Number of clusters (method '%s'): %d", method, nc, domain = "R-cluster"), "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/coef.R Recommended/cluster/R/coef.R
23c23
<     ## stopifnot(all.equal(1:n, sort(-mrg[mrg < 0])))
---
>     ## stopifnot(all.equal(seq_len(n), sort(-mrg[mrg < 0])))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/daisy.q Recommended/cluster/R/daisy.q
7c7
< 	stop("x is not a dataframe or a numeric matrix.")
---
> 	stop(gettextf("'%s' argument is not a dataframe or a numeric matrix.", "x"))
69,73c69,71
<     if(n > 9 && any(tI) &&
<        any(iBin <- apply(x[, tI, drop = FALSE], 2,
< 			 function(v) length(table(v)) == 2)))
< 	warning(gettextf("binary variable(s) %s treated as interval scaled",
< 			 pColl(which(tI)[iBin])))
---
>     if(n > 9 && any(tI) && any(iBin <- apply(x[, tI, drop = FALSE], 2, function(v) length(table(v)) == 2)))
> 	#warning(sprintf(ngettext(as.integer(length(which(tI))), "binary variable %s treated as interval scaled", "binary variables %s treated as interval scaled"), pColl(which(tI)[iBin])))
> 	warning(gettextf("binary variable(s) %s treated as interval scaled", pColl(which(tI)[iBin])))
80c78
< 				 "setting 'logical' variables %s to type 'asymm'"),
---
> 				 "setting 'logical' variables %s to type 'asymm'", domain = "R-cluster"),
94,96c92
< 		warning(gettextf(
< 		    "%s has constant columns %s; these are standardized to 0",
< 		    sQuote("x"), pColl(which(sx == 0))))
---
> 		warning(gettextf("%s has constant columns %s; these are standardized to 0", sQuote("x"), pColl(which(sx == 0))))
129,130c125
< 	stop(gettextf("invalid type %s for column numbers %s",
< 		      type2[ina], pColl(which(ina))))
---
> 	stop(gettextf("invalid type %s for column numbers %s", type2[ina], pColl(which(ina))))
162c157
< 	"NA-values in the dissimilarity matrix !"
---
> 	gettext("NA values in the dissimilarity matrix!")
176c171
<     cat("Dissimilarities :\n")
---
>     cat(gettext("Dissimilarities:", domain = "R-cluster"), "\n", sep = "")
180,181c175,176
< 	cat("Warning : ", attr(x, "NA.message"), "\n")
<     cat("Metric : ", attr(x, "Metric"),
---
> 	cat(gettext("Warning: ", domain = "R-cluster"), attr(x, "NA.message"), "\n", sep = "")
>     cat(gettext("Metric: ", domain = "R-cluster"), attr(x, "Metric"), sep = "")
183,184c178,180
< 	paste(";  Types =", paste(aT, collapse=", ")), "\n")
<     cat("Number of objects : ", attr(x, "Size"), "\n", sep="")
---
> 	cat(";  ", gettextf("Types = %s", paste(aT, collapse = ", "), domain = "R-cluster"), sep = "")
>     cat("\n")
>     cat(gettext("Number of objects:", domain = "R-cluster"), " ", attr(x, "Size"), "\n", sep = "")
201c197
<     cat(x$n, "dissimilarities, summarized :\n")
---
>     cat(sprintf(ngettext(x$n, "%d dissimilarity, summarized:", "%d dissimilarities, summarized:", domain = "R-cluster"), x$n), "\n", sep = "")
203c199
<     cat("Metric : ", x $ Metric,
---
>     cat(gettext("Metric: ", domain = "R-cluster"), x$Metric, sep = "")
205,206c201,203
< 	paste(";  Types =", paste(aT, collapse=", ")), "\n")
<     cat("Number of objects : ", x $ Size, "\n", sep="")
---
> 	cat(";  ", gettextf("Types = %s", paste(aT, collapse = ", "), domain = "R-cluster"), sep = "")
>     cat("\n")
>     cat(gettext("Number of objects:", domain = "R-cluster"), " ", x$Size, "\n", sep = "")
208c205
< 	cat("Warning : ", x $ NA.message, "\n")
---
> 	cat(gettext("Warning: ", domain = "R-cluster"), x$NA.message, "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/diana.q Recommended/cluster/R/diana.q
17c17
< 		    stop("'x' is not and cannot be converted to class \"dissimilarity\"")
---
> 		    stop(gettextf("'%s' argument is not and cannot be converted to class \"dissimilarity\"", "x"))
35c35
< 	if(!is.numeric(x)) stop("x is not a numeric dataframe or matrix.")
---
> 	if(!is.numeric(x)) stop(gettextf("'%s' argument is not a numeric dataframe or matrix.", "x"))
112c112
<     cat("Merge:\n")
---
>     cat(gettext("Merge:", domain = "R-cluster"), "\n", sep = "")
114c114
<     cat("Order of objects:\n")
---
>     cat(gettext("Order of objects:", domain = "R-cluster"), "\n", sep = "")
117c117
<     cat("Height:\n")
---
>     cat(gettext("Height:", domain = "R-cluster"), "\n", sep = "")
119c119
<     cat("Divisive coefficient:\n")
---
>     cat(gettext("Divisive coefficient:", domain = "R-cluster"), "\n", sep = "")
121c121
<     cat("\nAvailable components:\n")
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "")
134,135c134,135
<     cat("Merge:\n");			print(x$merge, ...)
<     cat("Order of objects:\n")
---
>     cat(gettext("Merge:", domain = "R-cluster"), "\n", sep = "");			print(x$merge, ...)
>     cat(gettext("Order of objects:", domain = "R-cluster"), "\n", sep = "")
137,138c137,138
<     cat("Height:\n");			print(x$height, ...)
<     cat("Divisive coefficient:\n");	print(x$dc, ...)
---
>     cat(gettext("Height:", domain = "R-cluster"), "\n", sep = "");			print(x$height, ...)
>     cat(gettext("Divisive coefficient:", domain = "R-cluster"), "\n", sep = "");	print(x$dc, ...)
142c142
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/ellipsoidhull.R Recommended/cluster/R/ellipsoidhull.R
37,38c37
<         cat("Error in Fortran routine computing the spanning ellipsoid,",
<             "\n probably collinear data\n", sep="")
---
>         cat(gettext("Error in Fortran routine computing the spanning ellipsoid. Probably collinear data", domain = "R-cluster"), "\n", sep="")
68,71c67
<     cat("'ellipsoid' in", d, "dimensions:\n center = (",
<         format(x$loc, digits=digits),
<         "); squared ave.radius d^2 = ", format(x$d2, digits=digits),
<         "\n and shape matrix =\n")
---
>     cat(gettextf("ellipsoid in %d dimensions:\n center = (%s); squared ave.radius d^2 = %s\n and shape matrix =\n", d, paste(format(x$loc, digits=digits), collapse = " "), format(x$d2, digits=digits), domain = "R-cluster"))
73,74c69,70
<     cat("  hence,",if(d==2)"area" else "volume"," = ",
<         format(volume(x), digits=digits),"\n")
---
>     if(d==2) cat(gettextf("  ellipsoid's area = %s", format(volume(x), digits=digits), domain = "R-cluster"), "\n", sep = "")
> 	else cat(gettextf("  ellipsoid's volume = %s", format(volume(x), digits=digits), domain = "R-cluster"), "\n", sep = "")
76,78c72,75
<         cat("\n** Warning: ** the algorithm did not terminate reliably!\n  ",
<             if(x$ierr) "most probably because of collinear data"
<             else "(in the available number of iterations)", "\n")
---
>         if(x$ierr)
>           cat("\n", gettext("** Warning: ** the algorithm did not terminate reliably!\n  most probably because of collinear data", domain = "R-cluster"), "\n", sep = "")
>         else
> 	  cat("\n", gettext("** Warning: ** the algorithm did not terminate reliably!\n  (in the available number of iterations)", domain = "R-cluster"), "\n", sep = "")
90c87
< ##   Return (x[i],y[i]) points, i = 1:n, on boundary of ellipse, given
---
> ##   Return (x[i],y[i]) points, i = seq_len(n), on boundary of ellipse, given
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/fanny.q Recommended/cluster/R/fanny.q
18c18
< 		    stop("'x' is not and cannot be converted to class \"dissimilarity\"")
---
> 		    stop(gettextf("'%s' argument is not and cannot be converted to class \"dissimilarity\"", "x"))
36c36
< 	if(!is.numeric(x)) stop("x is not a numeric dataframe or matrix.")
---
> 	if(!is.numeric(x)) stop(gettextf("'%s' argument is not a numeric dataframe or matrix.", "x"))
118c118
< 	    stop("No clustering performed, NA-values in the dissimilarity matrix.")
---
> 	    stop("No clustering performed, NA values in the dissimilarity matrix.")
157c157
<                           clus.avg.widths = res$avsil[1:k],
---
>                           clus.avg.widths = res$avsil[seq_len(k)],
170c170
<     cat("Fuzzy Clustering object of class 'fanny' :")
---
>     cat(gettext("Fuzzy Clustering object of class 'fanny': ", domain = "R-cluster"))
177,179c177,179
<     cat("Membership coefficients (in %, rounded):\n"); print(round(100 * x$membership), ...)
<     cat("Fuzzyness coefficients:\n");	print(x$coeff, digits = digits, ...)
<     cat("Closest hard clustering:\n");	print(x$clustering, ...)
---
>     cat(gettext("Membership coefficients (in percent, rounded):", domain = "R-cluster"), "\n", sep = ""); print(round(100 * x$membership), ...)
>     cat(gettext("Fuzzyness coefficients:", domain = "R-cluster"), "\n", sep = "");	print(x$coeff, digits = digits, ...)
>     cat(gettext("Closest hard clustering:", domain = "R-cluster"), "\n", sep = "");	print(x$clustering, ...)
181c181
< 	cat(sprintf("k_crisp (= %d) < k !!\n", x$k.crisp))
---
> 	cat(gettextf("k_crisp (= %d) < k !!", x$k.crisp, domain = "R-cluster"), "\n", sep = "")
187c187
<     cat("\nAvailable components:\n")
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "")
202c202
< 	cat("\nSilhouette plot information:\n")
---
> 	cat("\n", gettext("Silhouette plot information:", domain = "R-cluster"), "\n", sep = "")
204c204
< 	cat("Average silhouette width per cluster:\n")
---
> 	cat(gettext("Average silhouette width per cluster:", domain = "R-cluster"), "\n", sep = "")
206c206
< 	cat("Average silhouette width of total data set:\n")
---
> 	cat(gettext("Average silhouette width of total data set:", domain = "R-cluster"), "\n", sep = "")
212c212
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
227,228c227,228
<     if(any(u != 1:k)) clustering <- match(clustering, u)
<     r[cbind(1:n, clustering)] <- 1L
---
>     if(any(u != seq_len(k))) clustering <- match(clustering, u)
>     r[cbind(seq_len(n), clustering)] <- 1L
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/internal.R Recommended/cluster/R/internal.R
25c25
<     if(n1 < 1) stop("'n' must be >= 2")
---
>     if(n1 < 1) stop("'n' argument must be >= 2")
33c33
<     if((n2 <- as.integer(n - 2L)) < 0) stop("'n' must be >= 2")
---
>     if((n2 <- as.integer(n - 2L)) < 0) stop("'n' argument must be >= 2")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/mona.q Recommended/cluster/R/mona.q
6c6
<         stop("x must be a matrix or data frame.")
---
>         stop("'x' must be a matrix or data frame.")
51c51
<     ##O                                      1:nchar(res$x2), 1:nchar(res$x2))),
---
>     ##O                                      seq_len(nchar(res$x2)), seq_len(nchar(res$x2)))),
74c74
<     cat("Revised data:\n")
---
>     cat(gettext("Revised data:", domain = "R-cluster"), "\n", sep = "")
76c76
<     cat("Order of objects:\n")
---
>     cat(gettext("Order of objects:", domain = "R-cluster"), "\n", sep = "")
79c79
<     cat("Variable used:\n")
---
>     cat(gettext("Variable used:", domain = "R-cluster"), "\n", sep = "")
81c81
<     cat("Separation step:\n")
---
>     cat(gettext("Separation step:", domain = "R-cluster"), "\n", sep = "")
83c83
<     cat("\nAvailable components:\n")
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/pam.q Recommended/cluster/R/pam.q
24c24
< 		    stop("'x' is not and cannot be converted to class \"dissimilarity\"")
---
> 		    stop(gettextf("'%s' argument is not and cannot be converted to class \"dissimilarity\"", "x"))
47c47
< 	if(!is.numeric(x)) stop("x is not a numeric dataframe or matrix.")
---
> 	if(!is.numeric(x)) stop(gettextf("'%s' argument is not a numeric dataframe or matrix.", "x"))
76,78c76
< 	    stop(gettextf(
< 		"'medoids' must be NULL or vector of %d distinct indices in {1,2, .., n}, n=%d",
< 		k, n))
---
> 	    stop(gettextf("'medoids' must be NULL or vector of %d distinct indices in {1,2, .., n}, n=%d", k, n))
128c126
< 	stop("No clustering performed, NAs in the computed dissimilarity matrix.")
---
> 	stop("No clustering performed, NA values in the computed dissimilarity matrix.")
170c168
<     names(r.isol) <- 1:k
---
>     names(r.isol) <- seq_len(k)
184c182
< 		      clus.avg.widths = res$avsil[1:k],
---
> 		      clus.avg.widths = res$avsil[seq_len(k)],
199,201c197,199
<     cat("Medoids:\n");		print(cbind(ID = x$id.med, x$medoids), ...)
<     cat("Clustering vector:\n");	print(x$clustering, ...)
<     cat("Objective function:\n");	print(x$objective, ...)
---
>     cat(gettext("Medoids:", domain = "R-cluster"), "\n", sep = "");		print(cbind(ID = x$id.med, x$medoids), ...)
>     cat(gettext("Clustering vector:", domain = "R-cluster"), "\n", sep = "");	print(x$clustering, ...)
>     cat(gettext("Objective function:", domain = "R-cluster"), "\n", sep = "");	print(x$objective, ...)
207c205
<     cat("\nAvailable components:\n")
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "")
221,222c219,220
<     cat("\nNumerical information per cluster:\n"); print(x$clusinfo, ...)
<     cat("\nIsolated clusters:\n L-clusters: ")
---
>     cat("\n", gettext("Numerical information per cluster:", domain = "R-cluster"), "\n", sep = ""); print(x$clusinfo, ...)
>     cat("\n", gettext("Isolated clusters:", domain = "R-cluster"), "\n ", gettext("L-clusters: ", domain = "R-cluster"), sep = "")
224c222
<     cat(" L*-clusters: ")
---
>     cat(gettext(" L*-clusters: ", domain = "R-cluster"))
227c225
< 	cat("\nSilhouette plot information:\n")
---
> 	cat("\n", gettext("Silhouette plot information:", domain = "R-cluster"), "\n", sep = "")
229c227
< 	cat("Average silhouette width per cluster:\n")
---
> 	cat(gettext("Average silhouette width per cluster:", domain = "R-cluster"), "\n", sep = "")
231c229
< 	cat("Average silhouette width of total data set:\n")
---
> 	cat(gettext("Average silhouette width of total data set:", domain = "R-cluster"), "\n", sep = "")
237c235
<     cat("\nAvailable components:\n");	print(names(x), ...)
---
>     cat("\n", gettext("Available components:", domain = "R-cluster"), "\n", sep = "");	print(names(x), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/plothier.q Recommended/cluster/R/plothier.q
6,7c6,7
< pltree.twins <- function(x, main = paste("Dendrogram of ", deparse(x$call)),
< 			 labels = NULL, ylab = "Height", ...)
---
> pltree.twins <- function(x, main = gettextf("Dendrogram of %s", paste(deparse(x$call), collapse = ""), domain = "R-cluster"),
> 			 labels = NULL, ylab = gettext("Height", domain = "R-cluster"), ...)
24c24
<          xlab = "Height", adj = 0, col = c(2, 0), border = 0,
---
>          xlab = gettext("Height", domain = "R-cluster"), adj = 0, col = c(2, 0), border = 0,
91c91
< 	 sub = paste("Agglomerative Coefficient = ", round(x$ac, digits = 2)),
---
> 	 sub = gettextf("Agglomerative Coefficient = %s", round(x$ac, digits = 2), domain = "R-cluster"),
98,99c98,99
< 	main1 <- paste("Banner of ", cl)
< 	main2 <- paste("Dendrogram of ", cl)
---
> 	main1 <- gettextf("Banner of %s", cl, domain = "R-cluster")
> 	main2 <- gettextf("Dendrogram of %s", cl, domain = "R-cluster")
114c114
< 			     "\nMake a plot selection (or 0 to exit):\n") + 1
---
> 			     paste("\n", gettext("Make a plot selection (or 0 to exit):", domain = "R-cluster"), "\n", sep = "")) + 1
147c147
< 	 sub  = paste("Divisive Coefficient = ", round(x$dc, digits = 2)),
---
> 	 sub  = gettextf("Divisive Coefficient = %s", round(x$dc, digits = 2), domain = "R-cluster"),
154,155c154,155
< 	main1 <- paste("Banner of ", cl)
< 	main2 <- paste("Dendrogram of ", cl)
---
> 	main1 <- gettextf("Banner of %s", cl, domain = "R-cluster")
> 	main2 <- gettextf("Dendrogram of %s", cl, domain = "R-cluster")
170c170
< 			     "\nMake a plot selection (or 0 to exit):\n") + 1
---
> 			     paste("\n", gettext("Make a plot selection (or 0 to exit):", domain = "R-cluster"), "\n", sep = "")) + 1
200,201c200,201
< plot.mona <- function(x, main = paste("Banner of ", deparse(x$call)),
< 		      sub = NULL, xlab = "Separation step",
---
> plot.mona <- function(x, main = gettextf("Banner of %s", deparse(x$call), domain = "R-cluster"),
> 		      sub = NULL, xlab = gettext("Separation step", domain = "R-cluster"),
215c215
<     text(w, 1:length(names) - 0.5, names, adj = 0, col = col[1], ...)
---
>     text(w, seq_len(length(names)) - 0.5, names, adj = 0, col = col[1], ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/plotpart.q Recommended/cluster/R/plotpart.q
20,21c20,21
< 	tmenu <- paste("plot ", ## choices :
< 		       c("All", "Clusplot", "Silhouette Plot"))
---
> 	tmenu <- c("plot All", "plot Clusplot", "plot Silhouette Plot") ## choices
> 
26c26
< 			     "\nMake a plot selection (or 0 to exit):\n") + 1
---
> 			     paste("\n", gettext("Make a plot selection (or 0 to exit):", domain = "R-cluster"), "\n", sep = "")) + 1
73c73
< 	    stop("NA-values are not allowed in dist-like 'x'.")
---
> 	    stop("NA values are not allowed in dist-like 'x'.")
100c100
< 			if(is.null(labs)) labs <- 1:siz
---
> 			if(is.null(labs)) labs <- seq_len(siz)
115c115
< 	if(!is.matrix(x)) stop("x is not a data matrix")
---
> 	if(!is.matrix(x)) stop("'x' is not a data matrix")
153,156c153,155
< 	 main = paste("CLUSPLOT(", deparse(substitute(x)),")"),
< 	 sub = paste("These two components explain",
< 	       round(100 * var.dec, digits = 2), "% of the point variability."),
< 	 xlab = "Component 1", ylab = "Component 2",
---
> 	 main = gettextf("CLUSPLOT(%s)", deparse(substitute(x))),
> 	 sub = gettextf("These two components explain %s percent of the point variability.", round(100 * var.dec, digits = 2)),
> 	 xlab = gettext("Component 1", domain = "R-cluster"), ylab = gettext("Component 2", domain = "R-cluster"),
164c163
< 	stop("x is not numeric")
---
> 	stop("'x' is not numeric")
179c178
< 	stop("NA-values are not allowed in clustering vector")
---
> 	stop("NA values are not allowed in clustering vector")
195c194
<     for(i in 1:nC) { ##-------------  i-th cluster  --------------
---
>     for(i in seq_len(nC)) { ##-------------  i-th cluster  --------------
200c199
< 			 cat("cluster",i," has only one observation ..\n")
---
> 			 cat(gettextf("cluster %d  has only one observation ..", i, domain = "R-cluster"), "\n", sep = "")
288c287
< 		    cat("span & rank2 : calling \"spannel\" ..\n")
---
> 		    cat(gettext("span & rank2 : calling \"spannel\" ..", domain = "R-cluster"), "\n", sep = "")
314,316c313
< 		    cat("ellipse( A= (", format(cov[1,]),"*", format(cov[2,2]),
< 			"),\n\td2=", format(d2[i]),
< 			", loc[]=", format(loc[i, ]), ")\n")
---
> 		    cat(sprintf("ellipse( A= (%s*%s),\n\td2=%s, loc[]=%s)", format(cov[1,]), format(cov[2,2]), format(d2[i]), format(loc[i, ])), "\n", sep = "")
357c354
< 	    stop("'col.clus' should have length 4 when color is TRUE")
---
> 	    stop("'col.clus' argument should have length 4 when color is TRUE")
359,360c356,357
< 	jInd <- if(nC > 4) pam(verhoud[i.verh], 4)$clustering else 1:nC
< 	for(i in 1:nC) {
---
> 	jInd <- if(nC > 4) pam(verhoud[i.verh], 4)$clustering else seq_len(nC)
> 	for(i in seq_len(nC)) {
368c365
< 	for(i in 1:nC)
---
> 	for(i in seq_len(nC))
376c373
< 	for(i in 1:nC) {
---
> 	for(i in seq_len(nC)) {
406c403
< 	for(i in 1:(nC - 1)) {
---
> 	for(i in seq_len(nC - 1)) {
465c462
< 	    for(i in 1:nC) { ## add cluster border points
---
> 	    for(i in seq_len(nC)) { ## add cluster border points
512,513c509
< 		stop(gettextf("no diss nor data found, nor the original argument of %s",
< 			      deparse(x$call)))
---
> 		stop(gettextf("no diss nor data found, nor the original argument of %s", deparse(x$call)))
519c515
< 	else stop("no diss nor data found for clusplot()'")
---
> 	else stop("no diss nor data found for 'clusplot()' function")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/R/silhouette.R Recommended/cluster/R/silhouette.R
53c53
<     for(j in 1:k) { # j-th cluster:
---
>     for(j in seq_len(k)) { # j-th cluster:
88c88
< 	x <- as.integer(fx <- factor(x)) # now *has* values in 1:k
---
> 	x <- as.integer(fx <- factor(x)) # now *has* values in seq_len(k)
136c136
< 	    attr(object, "iOrd") <- 1:n
---
> 	    attr(object, "iOrd") <- seq_len(n)
141c141
<         rownames(object) <- as.character(1:n)
---
>         rownames(object) <- as.character(seq_len(n))
174c174,182
<     cls <- paste("Cluster sizes",
---
> 
>     if(!is.null(x$call)) {
>      if(!is.null(x$codes))
>     cat(gettextf("Silhouette of %d units in %d clusters from %s:", sum(csiz), k, deparse(x$call), domain = "R-cluster"), "\n",
>         gettextf("Cluster sizes, ids = (%s), and average silhouette widths:", paste(x$codes, collapse=", "), domain = "R-cluster"), "\n", sep = "")
>      else
>     cat(gettextf("Silhouette of %d units in %d clusters from %s:", sum(csiz), k, deparse(x$call), domain = "R-cluster"), "\n",
>         gettextf("Cluster sizes and average silhouette widths:", domain = "R-cluster"), "\n", sep = "")
>     } else {
176,180c184,189
<                  paste(", ids = (",paste(x$codes, collapse=", "),"),", sep=""),
<                  sep="")
<     cat("Silhouette of", sum(csiz), "units in", k, "clusters",
<         if(!is.null(x$call)) paste("from", deparse(x$call)), ":\n",
<         cls, "and average silhouette widths:\n")
---
>     cat(gettextf("Silhouette of %d units in %d clusters:", sum(csiz), k, domain = "R-cluster"), "\n",
>         gettextf("Cluster sizes, ids = (%s), and average silhouette widths:", paste(x$codes, collapse=", "), domain = "R-cluster"), "\n", sep = "")
>      else
>     cat(gettextf("Silhouette of %d units in %d clusters:", sum(csiz), k, domain = "R-cluster"), "\n",
>         gettext("Cluster sizes and average silhouette widths:", domain = "R-cluster"), "\n", sep = "")
>     }
184c193
<     cat("Individual silhouette widths:\n")
---
>     cat(gettext("Individual silhouette widths:", domain = "R-cluster"), "\n", sep = "")
210c219
< 	main <- "Silhouette plot"
---
> 	main <- gettext("Silhouette plot", domain = "R-cluster")
214c223
< 	    main <-  paste(main, "of", sub("^FF","", deparse(cll)))
---
> 	    main <-  gettextf("Silhouette plot of %s", sub("^FF","", deparse(cll)), domain = "R-cluster")
220c229
< 	sub <- paste("Average silhouette width : ",
---
> 	sub <- paste(gettext("Average silhouette width:", domain = "R-cluster"),
245c254
< 	for(j in 1:k) {
---
> 	for(j in seq_len(k)) {
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/man/bannerplot.Rd Recommended/cluster/man/bannerplot.Rd
11c11
<            main=NULL, sub=NULL, xlab = "Height",  adj = 0,
---
>            main=NULL, sub=NULL, xlab = gettext("Height", domain = "R-cluster"),  adj = 0,
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/man/pltree.Rd Recommended/cluster/man/pltree.Rd
13,14c13,14
< \method{pltree}{twins}(x, main = paste("Dendrogram of ", deparse(x$call)),
<              labels = NULL, ylab = "Height", \dots)
---
> \method{pltree}{twins}(x, main = gettextf("Dendrogram of \%s", paste(deparse(x$call), collapse = ""), domain = "R-cluster"),
>              labels = NULL, ylab = gettext("Height", domain = "R-cluster"), \dots)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/src/clara.c Recommended/cluster/src/clara.c
19a20
> #include "localization.h"
40,41c41
< 	      int *nsel,
< 	      int *nbest,/* x[nbest[j],] : the j-th obs in the final sample */
---
> 		int *nsel, int *nbest,/* x[nbest[j],] : the j-th obs in the final sample */
43,48c43,45
< 	      double *radus, double *ttd, double *ratt,
< 	      double *ttbes, double *rdbes, double *rabes,
< 	      int *mtt, double *obj,
< 	      double *avsyl, double *ttsyl, double *sylinf,
< 	      int *jstop, int *trace_lev,
< 	      double *tmp, /* = double [ 3 * nsam ] */
---
> 		double *radus, double *ttd, double *ratt, double *ttbes, double *rdbes,
> 		double *rabes, int *mtt, double *obj, double *avsyl, double *ttsyl,
> 		double *sylinf, int *jstop, int *trace_lev, double *tmp, /* = double [ 3 * nsam ] */
50,51c47
<     )
< {
---
> 		) {
65,66c61
<     Rboolean nafs, kall, full_sample, lrg_sam, dyst_toomany_NA,
< 	has_NA = *mdata;
---
> 	Rboolean nafs, kall, full_sample, lrg_sam, dyst_toomany_NA, has_NA = *mdata;
84,86c79,82
<     if(*trace_lev) Rprintf("C clara(): (nsam,nran,n) = (%d,%d,%d);%s\n",
< 			   *nsam, *nran, *n,
< 			   full_sample ? " 'full_sample',":
---
> 	if (*trace_lev)
> 		Rprintf("C clara(): (nsam,nran,n) = (%d,%d,%d);%s\n", *nsam, *nran, *n,
> 				full_sample ?
> 						" 'full_sample'," :
90c86,87
<     else /* << initialize `random seed' of the very simple randm() below */
---
> 	else
> 		/* << initialize `random seed' of the very simple randm() below */
113c110,111
< 	if(*trace_lev) Rprintf("C clara(): sample %d ", jran);
---
> 		if (*trace_lev)
> 			Rprintf("C clara(): sample %d ", jran);
119c117,118
< 		if(*trace_lev >= 2) Rprintf(" if (kall && nunfs...): \n");
---
> 				if (*trace_lev >= 2)
> 					Rprintf(" if (kall && nunfs...): \n");
133c132,133
< 		    nsel[jsm] = nsel[jk]; nsel[jk] = nsm;
---
> 					nsel[jsm] = nsel[jk];
> 					nsel[jk] = nsm;
136,138c136,138
< 	    }
< 	    else { /* no valid sample  _OR_  lrg_sam */
< 		if(*trace_lev >= 2) Rprintf(" finding 1st... new k{ran}:\n");
---
> 			} else { /* no valid sample  _OR_  lrg_sam */
> 				if (*trace_lev >= 2)
> 					Rprintf(" finding 1st... new k{ran}:\n");
162c162,163
< 		    for (jk = 0; jk < *kk; jk++) Rprintf("%d ",nrx[jk]);
---
> 					for (jk = 0; jk < *kk; jk++)
> 						Rprintf("%d ", nrx[jk]);
164c165,166
< 		    for (jk = 0; jk < ntt; jk++) Rprintf("%d ",nsel[jk]);
---
> 					for (jk = 0; jk < ntt; jk++)
> 						Rprintf("%d ", nsel[jk]);
196,197c198
< 	    L290:
< 		++ntt;
---
> 				L290: ++ntt;
200,201c201,202
< 	L295:
< 	    if(*trace_lev) Rprintf(" {295} [ntt=%d, nunfs=%d] ", ntt, nunfs);
---
> 			L295: if (*trace_lev)
> 				Rprintf(" {295} [ntt=%d, nunfs=%d] ", ntt, nunfs);
215,217c216,217
< 		for (jk = 0; jk < *nsam; jk++) Rprintf("%d ",nsel[jk]);
< 	    }
< 	    if(*trace_lev) Rprintf(" -> dysta2()\n");
---
> 				for (jk = 0; jk < *nsam; jk++)
> 					Rprintf("%d ", nsel[jk]);
219c219,221
< 	else { /* full_sample : *n = *nsam -- one sample is enough ! */
---
> 			if (*trace_lev)
> 				Rprintf(" -> dysta2()\n");
> 		} else { /* full_sample : *n = *nsam -- one sample is enough ! */
224,225c226,227
< 	dysta2(*nsam, *jpp, nsel, x, *n, dys, *diss_kind,
< 	       jtmd, valmd, has_NA, &dyst_toomany_NA);
---
> 		dysta2(*nsam, *jpp, nsel, x, *n, dys, *diss_kind, jtmd, valmd, has_NA,
> 				&dyst_toomany_NA);
258,259c260
< 	}
< 	else if(!kall || zba > zb) { /* 1st proper sample  or  new best */
---
> 		} else if (!kall || zba > zb) { /* 1st proper sample  or  new best */
261c262,263
< 	    if(*trace_lev >= 2) Rprintf(" 1st proper or new best:");
---
> 			if (*trace_lev >= 2)
> 				Rprintf(" 1st proper or new best:");
273c275,276
< 	if(*trace_lev >= 2) Rprintf(" obj= %g\n", zb/rnn);
---
> 		if (*trace_lev >= 2)
> 			Rprintf(" obj= %g\n", zb / rnn);
275c278,279
< 	if(full_sample) break; /* out of resampling */
---
> 		if (full_sample)
> 			break; /* out of resampling */
281c285,288
<     if (nunfs >= *nran) { *jstop = 1; return; }
---
> 	if (nunfs >= *nran) {
> 		*jstop = 1;
> 		return;
> 	}
283c290,293
<     if (!kall) { *jstop = 2; return; }
---
> 	if (!kall) {
> 		*jstop = 2;
> 		return;
> 	}
291c301,302
< 		if(js+1 < *nsam) Rprintf(",");
---
> 				if (js + 1 < *nsam)
> 					Rprintf(",");
303,304c313,314
<     dysta2(*nsam, *jpp, nbest, x, *n, dys, *diss_kind, jtmd, valmd,
< 	   has_NA, &dyst_toomany_NA);
---
> 	dysta2(*nsam, *jpp, nbest, x, *n, dys, *diss_kind, jtmd, valmd, has_NA,
> 			&dyst_toomany_NA);
306c316,317
< 	error(_(
---
> 		error(
> 				_(
329,333c340,342
< 
< void dysta2(int nsam, int jpp, int *nsel,
< 	    double *x, int n, double *dys, int diss_kind,
< 	    int *jtmd, double *valmd, Rboolean has_NA, Rboolean *toomany_NA)
< {
---
> void dysta2(int nsam, int jpp, int *nsel, double *x, int n, double *dys,
> 		int diss_kind, int *jtmd, double *valmd, Rboolean has_NA,
> 		Rboolean *toomany_NA) {
341c350,352
< 	    error(_("C level dysta2(): nsel[%s= %d] = %d is outside 0..n, n=%d"),
---
> 			error(
> 					_(
> 							"C level dysta2(): nsel[%s= %d] = %d is outside 0..n, n=%d"),
346c357,359
< 		error(_("C level dysta2(): nsel[%s= %d] = %d is outside 0..n, n=%d"),
---
> 				error(
> 						_(
> 								"C level dysta2(): nsel[%s= %d] = %d is outside 0..n, n=%d"),
378,379c391
< double randm(int *nrun)
< {
---
> double randm(int *nrun) {
392,393c404
< 	    double s, const double dys[],
< 	    Rboolean pam_like, int trace_lev,
---
> double s, const double dys[], Rboolean pam_like, int trace_lev,
395,397c406
< 	    double *sky, int *nrepr,
< 	    double *dysma, double *dysmb, double *beter)
< {
---
> 		double *sky, int *nrepr, double *dysma, double *dysmb, double *beter) {
405c414,415
<     --dysma;	--dysmb;
---
> 	--dysma;
> 	--dysmb;
466c476,477
< 	    if(nrepr[i] == 1) Rprintf(" %2d", i);
---
> 			if (nrepr[i] == 1)
> 				Rprintf(" %2d", i);
471c482,483
< 		if(i % 10 == 0) Rprintf("\n");
---
> 				if (i % 10 == 0)
> 					Rprintf("\n");
473,474c485,488
< 	    if(n % 10 != 0) Rprintf("\n");
< 	} else Rprintf("\n");
---
> 			if (n % 10 != 0)
> 				Rprintf("\n");
> 		} else
> 			Rprintf("\n");
507,508c521,524
<     for (h = 1; h <= n; ++h) if (!nrepr[h]) {
<         for (i = 1; i <= n; ++i) if (nrepr[i]) {
---
> 	for (h = 1; h <= n; ++h)
> 		if (!nrepr[h]) {
> 			for (i = 1; i <= n; ++i)
> 				if (nrepr[i]) {
512,513c528
< 		int ij = ind_2(i, j),
< 		    hj = ind_2(h, j);
---
> 						int ij = ind_2(i, j), hj = ind_2(h, j);
518c533,534
< 		    else // old clara code which differs from pam()'s
---
> 							else
> 								// old clara code which differs from pam()'s
522,523c538
< 		}
< 		else if (dys[hj] < dysma[j])
---
> 						} else if (dys[hj] < dysma[j])
539,540c554,555
< 	    Rprintf( "   swp new %d <-> %d old; decreasing diss. by %g\n",
< 		     hbest, nbest, dzsky);
---
> 			Rprintf("   swp new %d <-> %d old; decreasing diss. by %g\n", hbest,
> 					nbest, dzsky);
553,557c568,570
< void selec(int kk, int n, int jpp, int diss_kind,
< 	   double *zb, int nsam, Rboolean has_NA, int *jtmd, double *valmd,
< 	   int trace_lev,
< 	   int *nrepr, int *nsel, double *dys, double *x, int *nr,
< 	   Rboolean *nafs, /* := TRUE if a distance cannot be calculated */
---
> void selec(int kk, int n, int jpp, int diss_kind, double *zb, int nsam,
> 		Rboolean has_NA, int *jtmd, double *valmd, int trace_lev, int *nrepr,
> 		int *nsel, double *dys, double *x, int *nr, Rboolean *nafs, /* := TRUE if a distance cannot be calculated */
561,562c574
< 	   double *ttnew, double *rdnew)
< {
---
> 		double *ttnew, double *rdnew) {
571c583,584
<     --nsel;    --nrepr;
---
> 	--nsel;
> 	--nrepr;
574,576c587,597
<     --radus; --ttd;    --np;	--nr;	 --ns;
< 
<     --rdnew; --ttnew; --npnew; --nrnew; --nsnew;
---
> 	--radus;
> 	--ttd;
> 	--np;
> 	--nr;
> 	--ns;
> 
> 	--rdnew;
> 	--ttnew;
> 	--npnew;
> 	--nrnew;
> 	--nsnew;
623,624c644
< 	}
< 	else { /* _has_ missing data */
---
> 		} else { /* _has_ missing data */
660c680,681
< 		*nafs = TRUE; return;
---
> 				*nafs = TRUE;
> 				return;
677c698,699
< 			goto L90;/* next jj */
---
> 						goto L90;
> 					/* next jj */
683,684c705
<     L90:
< 	;
---
> 		L90: ;
741,743c761,762
< void resul(int kk, int n, int jpp, int diss_kind, Rboolean has_NA,
< 	   int *jtmd, double *valmd, double *x, int *nrx, int *mtt)
< {
---
> void resul(int kk, int n, int jpp, int diss_kind, Rboolean has_NA, int *jtmd,
> 		double *valmd, double *x, int *nrx, int *mtt) {
754c773,774
< 		goto L220; /* continue next jj (i.e., outer loop) */
---
> 				goto L220;
> 			/* continue next jj (i.e., outer loop) */
775,776c795
< 	}
< 	else { /* _has_ missing data */
---
> 		} else { /* _has_ missing data */
807,808c826
<     L220:
< 	;
---
> 		L220: ;
828,829c844,845
< void black(int kk, int jpp, int nsam, int *nbest,
< 	   double *dys, double s, double *x,
---
> void black(int kk, int jpp, int nsam, int *nbest, double *dys, double s,
> 		double *x,
833,835c849,850
< 	   int *ncluv, int *nsend, int *nelem, int *negbr,
< 	   double *syl, double *srank)
< {
---
> 		int *ncluv, int *nsend, int *nelem, int *negbr, double *syl,
> 		double *srank) {
850,852c865,871
<     --srank;    --syl;
<     --negbr; --nelem; --nsend;
<     --ncluv;	--nbest;
---
> 	--srank;
> 	--syl;
> 	--negbr;
> 	--nelem;
> 	--nsend;
> 	--ncluv;
> 	--nbest;
906c925,926
< 		syl[j] = 0.;	    continue /* j */;
---
> 				syl[j] = 0.;
> 				continue /* j */;
929c949,950
< 		else /* (dysb == dysa) */
---
> 				else
> 					/* (dysb == dysa) */
936,937c957
< 	    }
< 	    else {
---
> 			} else {
970,971c990
< 	}
< 	else {
---
> 		} else {
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/src/cluster.h Recommended/cluster/src/cluster.h
7,12d6
< #ifdef ENABLE_NLS
< #include <libintl.h>
< #define _(String) dgettext ("cluster", String)
< #else
< #define _(String) (String)
< #endif
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/src/fanny.c Recommended/cluster/src/fanny.c
11a12
> #include "localization.h"
250c251
< 	if(trace_lev >= 2) Rprintf("  not converged: it = %d\n", it);
---
> 	if(trace_lev >= 2) Rprintf(_("  not converged: it = %d\n"), it);
258,259c259,265
< 	Rprintf("%s%sonverged after %d iterations,  obj = %#20.*g\n",
< 		trace_lev >=2 ? "\n" : "", (converged) ? "C" : "NOT c",
---
>      if(converged)
> 	Rprintf(_("%sConverged after %d iterations,  obj = %#20.*g\n"),
> 		trace_lev >=2 ? "\n" : "",
> 		it, (int)((trace_lev >= 2)? 20 : 7), cryt);
>      else
> 	Rprintf(_("%sNOT converged after %d iterations,  obj = %#20.*g\n"),
> 		trace_lev >=2 ? "\n" : "",
Only in Recommended/cluster/src: localization.h
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/src/pam.c Recommended/cluster/src/pam.c
17a18
> #include "localization.h"
312c313
< 	if(trace_lev) Rprintf("medoids given\n");
---
> 	if(trace_lev) Rprintf(_("medoids given\n"));
328c329
< 	if(trace_lev) Rprintf("build %d medoids:\n", kk);
---
> 	if(trace_lev) Rprintf(_("build %d medoids:\n"), kk);
359c360
< 		Rprintf("    new repr. %d\n", nmax);
---
> 		Rprintf(_("    new representative. %d\n"), nmax);
373c374
< 	Rprintf("  after build: medoids are");
---
> 	Rprintf(_("  after build: medoids are"));
377c378
< 	    Rprintf("\n  and min.dist dysma[1:n] are\n");
---
> 	    Rprintf(_("\n  and min.dist dysma[1:n] are\n"));
551c552
< 		Rprintf( "   swp new %*d <-> %*d old; decreasing diss. %7g by %g\n",
---
> 		Rprintf(_("   swp new %*d <-> %*d old; decreasing diss. %7g by %g\n"),
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/cluster/src/twins.c Recommended/cluster/src/twins.c
14a15
> #include "localization.h"
