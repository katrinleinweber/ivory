diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/VarCorr.R Recommended/nlme/R/VarCorr.R
48c48
<   trows <- 1L + c(0L, cumsum(1L + nrows))[1:Q]
---
>   trows <- 1L + c(0L, cumsum(1L + nrows))[seq_len(Q)]
69c69
<       v[ri, 2L + (1:ncol(corr[[i]])) ] <- corr[[i]]
---
>       v[ri, 2L + seq_len(ncol(corr[[i]])) ] <- corr[[i]]
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/VarCov.R Recommended/nlme/R/VarCov.R
28c28
<         stop("not implemented for \"nlme\" objects")
---
>         stop(gettextf("'%s' function is not implemented for objects of class %s", "getVarCov.lme()", dQuote("nlme")))
30c30
<         stop("not implemented for multiple levels of nesting")
---
>         stop(gettextf("'%s' function is not implemented for multiple levels of nesting", "getVarCov.lme()"))
48,53c48,49
<             if (!length(indx))
<                 stop(gettextf("individual %s was not used in the fit",
<                               sQuote(individ)), domain = NA)
<             if (is.na(indx))
<                  stop(gettextf("individual %s was not used in the fit",
<                               sQuote(individ)), domain = NA)
---
>             if (!length(indx) || is.na(indx))
>                 stop(gettextf("individual %s was not used in the fit", sQuote(individ)), domain = "R-nlme")
112c108
<             cat("correlation matrix\n")
---
>             cat(gettext("correlation matrix", domain = "R-nlme"), "\n", sep = "")
118c114
<             cat("variance covariance matrix\n")
---
>             cat(gettext("variance covariance matrix", domain = "R-nlme"), "\n", sep = "")
123c119
<         if (stdevs) cat("  Standard Deviations:",signif(sds,digits),"\n")
---
>         if (stdevs) cat(gettext("  Standard Deviations: ", domain = "R-nlme"), signif(sds,digits), "\n", sep = "")
131c127
<             cat(attr(x,"group.levels"),nm,"\n")
---
>             cat(attr(x,"group.levels"), " ", nm, "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/corStruct.R Recommended/nlme/R/corStruct.R
77,78c77
<       stop(gettextf("do not know how to calculate correlation matrix of %s object",
<                     dQuote(class(object)[1])), domain = NA)
---
>       stop(gettextf("do not know how to calculate correlation matrix of %s object", dQuote(class(object)[1])), domain = "R-nlme")
96c95
<       val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>       val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
122c121
<       stop("\"corStruct\" object must have a \"fixed\" attribute")
---
>       stop(gettextf("object of class %s must have a \"fixed\" attribute", dQuote("corStruct")))
130,131c129
<       stop(gettextf("do not know how to obtain parameters of %s object",
<                     dQuote(class(object)[1])), domain = NA)
---
>       stop(gettextf("do not know how to obtain parameters of %s object", dQuote(class(object)[1])), domain = "R-nlme")
140c138
<     stop("cannot change the length of the parameter of a \"corStruct\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corStruct")))
160,162c158,159
<       "'sumLenSq := sum(table(groups)^2)' = %g is too large.
<  Too large or no groups in your correlation structure?",
< 		  suml2), call. = FALSE, domain = NA)
---
>       "'sumLenSq := sum(table(groups)^2)' = %g is too large. Too large or no groups in your correlation structure?",
> 		  suml2), call. = FALSE, domain = "R-nlme")
180c177
<     warning("cannot change 'form'")
---
>     warning("cannot change 'form' argument")
184c181
<       stop("need data to calculate covariate of \"corStruct\" object")
---
>       stop(gettextf("'%s' argument is required in order to calculate covariate of an object of class %s", "data", dQuote("corStruct")))
202c199
<         covar <- 1:nrow(data)
---
>         covar <- seq_len(nrow(data))
282c279
<     cat("Correlation structure of class", class(x)[1], "representing\n")
---
>     cat(gettextf("Correlation structure of class %s representing", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
285c282
<     cat("Uninitialized correlation structure of class", class(x)[1], "\n")
---
>     cat(gettextf("Uninitialized correlation structure of class %s", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
293,295c290,292
<   cat(paste0("Correlation Structure: ", attr(x, "structName"), "\n"))
<   cat(paste(" Formula:", deparse(formula(x)),"\n"))
<   cat(" Parameter estimate(s):\n")
---
>   cat(gettext("Correlation structure: ", domain = "R-nlme"), attr(x, "structName"), "\n", sep = "")
>   cat(gettext(" Formula: ", domain = "R-nlme"), deparse(formula(x)), "\n", sep = "")
>   cat(gettext(" Parameter estimates:", domain = "R-nlme"), "\n", sep = "")
393c390
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
426c423
<     stop("cannot change the length of the parameter of a \"corSymm\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corSymm")))
455c452
<     stop("covariate must have unique values within groups for \"corSymm\" objects")
---
>     stop(gettextf("covariate must have unique values within groups for objects of class %s", dQuote("corSymm")))
460c457
<     stop("unique values of the covariate  for \"corSymm\" objects must be a sequence of consecutive integers")
---
>     stop(gettextf("unique values of the covariate  for objects of class %s must be a sequence of consecutive integers", dQuote("corSymm")))
472c469
<       stop("initial value for \"corSymm\" parameters of wrong dimension")
---
>       stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corSymm")))
475c472
<       stop("initial values for \"corSymm\" must be between -1 and 1")
---
>       stop(gettextf("initial values for %s must be between %d and %d", dQuote("corSymm"), -1, 1))
482c479
<       stop("initial values for \"corSymm\" do not define a positive-definite correlation structure")
---
>       stop(gettextf("initial values for %s do not define a positive-definite correlation structure", dQuote("corSymm")))
487c484
<       aux <- acos(natMat[1:(i-1),i]/sqrt(cumsum(natMat[i:1,i]^2)[i:2]))
---
>       aux <- acos(natMat[seq_len(i-1),i]/sqrt(cumsum(natMat[i:1,i]^2)[i:2]))
506c503
<     dimnames(val) <- list(1:mC, 1:mC)
---
>     dimnames(val) <- list(seq_len(mC), seq_len(mC))
509c506
<     cat("Correlation structure of class corSymm representing\n")
---
>     cat(gettextf("Correlation structure of class %s representing", dQuote("corSymm"), domain = "R-nlme"), "\n", sep = "")
512c509
<   else cat("Unitialized correlation structure of class corSymm\n")
---
>   else cat(gettextf("Uninitialized correlation structure of class %s", dQuote("corSymm"), domain = "R-nlme"), "\n", sep = "")
519,521c516,518
<     cat("Correlation Structure: General\n")
<     cat(paste(" Formula:", deparse(formula(x)),"\n"))
<     cat(" Parameter estimate(s):\n")
---
>     cat(gettext("Correlation Structure: General", domain = "R-nlme"), "\n", sep = "")
>     cat(gettext(" Formula: ", domain = "R-nlme"), deparse(formula(x)), "\n", sep = "")
>     cat(gettext(" Parameter estimates:", domain = "R-nlme"), "\n", sep = "")
523c520
<     dimnames(val) <- list(1:mC, 1:mC)
---
>     dimnames(val) <- list(seq_len(mC), seq_len(mC))
527c524
<   } else cat("Unitialized correlation structure of class corSymm\n")
---
>   } else cat(gettextf("Uninitialized correlation structure of class %s", dQuote("corSymm"), domain = "R-nlme"), "\n", sep = "")
547c544
< summary.corSymm <- function(object, structName = "General correlation", ...)
---
> summary.corSymm <- function(object, structName = gettext("General correlation", domain = "R-nlme"), ...)
614c611
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
643c640
<   names(val) <- outer(1:mC, 1:mC, function(x,y) paste0("cor(",y,",",x,")"))[
---
>   names(val) <- outer(seq_len(mC), seq_len(mC), function(x,y) paste0("cor(",y,",",x,")"))[
651c648
<     stop("cannot change the length of the parameter of a \"corNatural\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corNatural")))
680c677
<     stop("covariate must have unique values within groups for \"corNatural\" objects")
---
>     stop(gettextf("covariate must have unique values within groups for objects of class %s", dQuote("corNatural")))
685c682
<     stop("unique values of the covariate for \"corNatural\" objects must be a sequence of consecutive integers")
---
>     stop(gettextf("unique values of the covariate  for objects of class %s must be a sequence of consecutive integers", dQuote("corNatural")))
697c694
<       stop("initial value for \"corNatural\" parameters of wrong dimension")
---
>       stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corNatural")))
700c697
<       stop("initial values for \"corNatural\" must be between -1 and 1")
---
>       stop(gettextf("initial values for %s must be between %d and %d", dQuote("corNatural"), -1, 1))
707c704
<       stop("initial values for \"corNatural\" do not define a positive-definite correlation structure")
---
>       stop(gettextf("initial values for %s do not define a positive-definite correlation structure", dQuote("corNatural")))
726c723
<     dimnames(val) <- list(1:mC, 1:mC)
---
>     dimnames(val) <- list(seq_len(mC), seq_len(mC))
729c726
<     cat("Correlation structure of class corNatural representing\n")
---
>     cat(gettextf("Correlation structure of class %s representing", dQuote("corNatural"), domain = "R-nlme"), "\n", sep = "")
732c729
<   else cat("Unitialized correlation structure of class corNatural\n")
---
>   else cat(gettextf("Uninitialized correlation structure of class %s", dQuote("corNatural"), domain = "R-nlme"), "\n", sep = "")
741,743c738,740
<     cat("Correlation Structure: General\n")
<     cat(paste(" Formula:", deparse(formula(x)),"\n"))
<     cat(" Parameter estimate(s):\n")
---
>     cat(gettext("Correlation Structure: General", domain = "R-nlme"), "\n", sep = "")
>     cat(gettext(" Formula: ", domain = "R-nlme"), deparse(formula(x)), "\n", sep = "")
>     cat(gettext(" Parameter estimates:", domain = "R-nlme"), "\n", sep = "")
746c743
<     dimnames(val) <- list(1:mC, 1:mC)
---
>     dimnames(val) <- list(seq_len(mC), seq_len(mC))
750c747
<   } else cat("Unitialized correlation structure of class corNatural\n")
---
>   } else cat(gettextf("Uninitialized correlation structure of class %s", dQuote("corNatural"), domain = "R-nlme"), "\n", sep = "")
773c770
<            structName = "General correlation, with natural parametrization",
---
>            structName = gettext("General correlation, with natural parametrization", domain = "R-nlme"),
827c824
<   function(object, structName = "Independent", ...)
---
>   function(object, structName = gettext("Independent", domain = "R-nlme"), ...)
841c838
<     stop("parameter in AR(1) structure must be between -1 and 1")
---
>     stop(gettextf("parameter in %s structure must be between %d and %d", dQuote("AR(1)"), -1, 1))
857c854
< 		  corD[["sumLenSq"]]), domain = NA)
---
> 		  corD[["sumLenSq"]]), domain = "R-nlme")
895c892
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
930c927
<     stop("cannot change the length of the parameter of a \"corAR1\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corAR1")))
955c952
<     stop("covariate must have unique values within groups for \"corAR1\" objects")
---
>     stop(gettextf("covariate must have unique values within groups for objects of class %s", dQuote("corAR1")))
1002c999
<     stop("parameter in CAR(1) structure must be between 0 and 1")
---
>     stop(gettextf("parameter in %s structure must be between %d and %d", dQuote("CAR(1)"), 0, 1))
1058c1055
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
1093c1090
<     stop("cannot change the length of the parameter of a \"corCAR1\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corCAR1")))
1120c1117
<     stop("covariate must have unique values within groups for \"corCAR1\" objects")
---
>     stop(gettextf("covariate must have unique values within groups for objects of class %s", dQuote("corCAR1")))
1144c1141
<   function(object, structName = "Continuous AR(1)", ...)
---
>   function(object, structName = gettext("Continuous AR(1)", domain = "R-nlme"), ...)
1170c1167
<     stop("parameters in ARMA structure must be < 1 in absolute value")
---
>     stop(gettextf("parameters in %s structure must be between %d and %d", dQuote("ARMA"), -1, 1))
1189c1186
<     if(is.null(maxLag)) stop("'object' has not been Initialize()d")
---
>     if(is.null(maxLag)) stop("'object' argument has not been initialized with 'Initialize()' function")
1220c1217
<   if(is.null(maxLag)) stop("'object' has not been Initialize()d")
---
>   if(is.null(maxLag)) stop("'object' argument has not been initialized with 'Initialize()' function")
1245c1242
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
1273c1270
<       nams <- paste(rep("Phi", p), 1:p, sep="")
---
>       nams <- paste(rep("Phi", p), seq_len(p), sep = "")
1276c1273
<       nams <- c(nams, paste(rep("Theta", q), 1:q, sep=""))
---
>       nams <- c(nams, paste(rep("Theta", q), seq_len(q), sep = ""))
1289c1286
<   if(is.null(maxLag)) stop("'object' has not been Initialize()d")
---
>   if(is.null(maxLag)) stop("'object' argument has not been initialized with 'Initialize()' function")
1291c1288
<     stop("cannot change the length of the parameter of a \"corARMA\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corARMA")))
1322c1319
<     stop("covariate must have unique values within groups for \"corARMA\" objects")
---
>     stop(gettextf("covariate must have unique values within groups for objects of class %s", dQuote("corARMA")))
1342c1339
<     if(is.null(maxLag)) stop("'object' has not been Initialize()d")
---
>     if(is.null(maxLag)) stop("'object' argument has not been initialized with 'Initialize()' function")
1375c1372
<     stop("parameter in \"corCompSymm\" structure must be < 1 in absolute value")
---
>     stop(gettextf("parameter in %s structure must be between %d and %d", dQuote("corCompSymm"), -1, 1))
1429c1426
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
1464c1461
<     stop("cannot change the length of the parameter of a \"corCompSymm\" object")
---
>     stop(gettextf("cannot change the length of the parameter of an object of class %s", dQuote("corCompSymm")))
1491,1492c1488
<       stop(gettextf("initial value in \"corCompSymm\" must be greater than %s",
<                     attr(object, "inf")), domain = NA)
---
>       stop(sprintf(gettext("initial value in \"corCompSymm\" must be greater than %s", domain = "R-nlme"), attr(object, "inf")), domain = NA)
1517c1513
<   function(object, structName = "Compound symmetry", ...)
---
>   function(object, structName = gettext("Compound symmetry", domain = "R-nlme"), ...)
1582c1578
< #    val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
> #    val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
1679c1675
< #  else cat("Unitialized correlation structure of class corHF\n")
---
> #  else cat("Uninitialized correlation structure of class corHF\n")
1779c1775
<     val <- split(val, rep(1:corD[["M"]], (corD[["len"]])^2))
---
>     val <- split(val, rep(seq_len(corD[["M"]]), (corD[["len"]])^2))
1843,1844c1839
<     match(class(object)[1], c("corSpher", "corExp", "corGaus", "corLin",
<                               "corRatio"), 0)
---
>     match(class(object)[1], c("corSpher", "corExp", "corGaus", "corLin", "corRatio"), 0)
1853c1848
<       stop("need data to calculate covariate")
---
>       stop(gettextf("'%s' argument is required in order to calculate covariate of an object of class %s", "data", dQuote("corSpatial")))
1884c1879
<             dist(1:nrow(data))
---
>             dist(seq_len(nrow(data)))
1889c1884
<       stop("cannot have zero distances in \"corSpatial\"")
---
>       stop("cannot have zero distances in an object of class \"corSpatial\"")
1907c1902
<       stop("'range' must be > 0 in \"corSpatial\" initial value")
---
>       stop(gettextf("'%s' argument must be > 0 in %s initial value", "range", dQuote("corSpatial")))
1914c1909
< 	  stop("initial value for \"corSpatial\" parameters of wrong dimension")
---
> 	  stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corSpatial")))
1922c1917
< 	stop("initial value for \"corSpatial\" parameters of wrong dimension")
---
> 	stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corSpatial")))
1997c1992
<   function(object, structName = "Exponential spatial correlation", ...)
---
>   function(object, structName = gettext("Exponential spatial correlation", domain = "R-nlme"), ...)
2027c2022
<   function(object, structName = "Gaussian spatial correlation", ...)
---
>   function(object, structName = gettext("Gaussian spatial correlation", domain = "R-nlme"), ...)
2077c2072
<       stop("'range' must be > 0 in \"corLin\" initial value")
---
>       stop(gettextf("'%s' argument must be > 0 in %s initial value", "range", dQuote("corLin")))
2088c2083
< 	  stop("initial value for \"corLin\" parameters of wrong dimension")
---
> 	  stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corLin")))
2096c2091
< 	stop("initial value for \"corLin\" parameters of wrong dimension")
---
> 	stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corLin")))
2115c2110
<   function(object, structName = "Linear spatial correlation", ...)
---
>   function(object, structName = gettext("Linear spatial correlation", domain = "R-nlme"), ...)
2145c2140
<   function(object, structName = "Rational quadratic spatial correlation", ...)
---
>   function(object, structName = gettext("Rational quadratic spatial correlation", domain = "R-nlme"), ...)
2209c2204
< 	  stop("initial value for \"corSpher\" parameters of wrong dimension")
---
> 	  stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corSpher")))
2217c2212
< 	stop("initial value for \"corSpher\" parameters of wrong dimension")
---
> 	stop(gettextf("initial value for %s parameters of wrong dimension", dQuote("corSpher")))
2236c2231
<   function(object, structName = "Spherical spatial correlation", ...)
---
>   function(object, structName = gettext("Spherical spatial correlation", domain = "R-nlme"), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/gls.R Recommended/nlme/R/gls.R
43c43
<         stop("\nmodel must be a formula of the form \"resp ~ pred\"")
---
>         stop("'model' argument must be a formula of the form \"resp ~ pred\"")
150,151c150,151
<         aConv <- c("beta" = max(conv[1:p]))
<         conv <- conv[-(1:p)]
---
>         aConv <- c("beta" = max(conv[seq_len(p)]))
>         conv <- conv[-(seq_len(p))]
159,160c159,160
<             cat("\nIteration:",numIter)
<             cat("\nObjective:", format(optRes$value), "\n")
---
>             cat("\n", gettext("Iteration: ", domain = "R-nlme"), numIter, sep = "")
>             cat("\n", gettext("Objective: ", domain = "R-nlme"), format(optRes$value), "\n", sep = "")
162c162
<             cat("\nConvergence:\n")
---
>             cat("\n", gettext("Convergence:", domain = "R-nlme"), "\n", sep = "")
205c205
<             "Approximate variance-covariance matrix not available"
---
>             gettext("Approximate variance-covariance matrix not available", domain = "R-nlme")
302c302
<             "Non-positive definite approximate variance-covariance"
---
>             gettext("Non-positive definite approximate variance-covariance", domain = "R-nlme")
325c325
<               pivot = as.integer(1:(p + 1L)),
---
>               pivot = as.integer(seq_len(p + 1L)),
330,331c330
<         stop(gettextf("computed \"gls\" fit is singular, rank %s", rnk),
<              domain = NA)
---
>         stop(gettextf("computed \"gls\" fit is singular, rank %s", rnk), domain = "R-nlme")
334c333
<     namCoef <- colnames(oXy)[val[["pivot"]][1:rnkm1] + 1L]	# coef names
---
>     namCoef <- colnames(oXy)[val[["pivot"]][seq_len(rnkm1)] + 1L]	# coef names
337c336
<     beta <- val[["beta"]][1:rnkm1]
---
>     beta <- val[["beta"]][seq_len(rnkm1)]
400c399
<                       nn[1:N] <- n + 1L - 1:N
---
>                       nn[seq_len(N)] <- n + 1L - seq_len(N)
402,403c401,402
<                       for(i in 1:N) {
<                           el1 <- el[1:(n-i+1L)]
---
>                       for(i in seq_len(N)) {
>                           el1 <- el[seq_len(n-i+1L)]
428c427
<             stop("object must inherit from class \"gls\"")
---
>             stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("gls")))
444c443
<         lab <- paste("Denom. DF:", dDF,"\n")
---
>         lab <- paste(gettext("Denom. DF: ", domain = "R-nlme"), dDF, "\n", sep = "")
450c449
<             for(i in 1:nTerms) {
---
>             for(i in seq_len(nTerms)) {
456c455
< 			qr.qty(qr(vBeta[, assign[[i]], drop = FALSE]), c0)[1:nDF[i]]
---
> 			qr.qty(qr(vBeta[, assign[[i]], drop = FALSE]), c0)[seq_len(nDF[i])]
470,471c469
<                         stop(gettextf("'Terms' must be between 1 and %d",
<                                       nTerms), domain = NA)
---
>                         stop(gettextf("'%s' argument must be between %d and %d", "Terms", 1, nTerms), domain = "R-nlme")
477,478c475,476
<                                                   "term %s not matched",
<                                                   "terms %s not matched"),
---
>                                                   "term %s was not matched",
>                                                   "terms %s were not matched", domain = "R-nlme"),
487,488c485
<                     paste(lab, "F-test for:",
<                           paste(names(assign[Terms]),collapse=", "),"\n")
---
>                     paste(lab, gettext(" F-test for: ", domain = "R-nlme"), paste(names(assign[Terms]), collapse = ", "), "\n", sep = "")
498c495
<                                           "'L' must have at most %d columns"),
---
>                                           "'L' must have at most %d columns", domain = "R-nlme"),
505c502
<                     L0[, 1:ncolL] <- L
---
>                     L0[, seq_len(ncolL)] <- L
509,512c506,508
<                                               "effect %s not matched",
<                                               "effects %s not matched"),
<                                      paste(dmsL2[noMatch],collapse=", ")),
<                              domain = NA)
---
>                                               "effect %s was not matched",
>                                               "effects %s were not matched", domain = "R-nlme"),
>                                      paste(dmsL2[noMatch], collapse = ", ")), domain = NA)
519,520c515,516
<                 rownames(L) <- if(is.null(dmsL1)) 1:nrowL else dmsL1[noZeroRowL]
<                 lab <- paste(lab, "F-test for linear combination(s)\n")
---
>                 rownames(L) <- if(is.null(dmsL1)) seq_len(nrowL) else dmsL1[noZeroRowL]
>                 lab <- paste(lab, gettext(" F-test for linear combinations", domain = "R-nlme"), "\n", sep = "")
523c519
<             c0 <- c(qr.qty(qr(vBeta %*% t(L)), c0))[1:nDF]
---
>             c0 <- c(qr.qty(qr(vBeta %*% t(L)), c0))[seq_len(nDF)]
556,557c552
<         stop(gettextf("data in %s call must evaluate to a data frame",
<                       sQuote(substitute(object))), domain = NA)
---
>         stop(gettextf("data in %s call must evaluate to a data frame", sQuote(substitute(object))), domain = "R-nlme")
561,562c556
<             stop(gettextf("%s without \"primary\" can only be used with fits of \"groupedData\" objects",
<                           sys.call()[[1L]]), domain = NA)
---
>             stop(gettextf("%s without \"primary\" can only be used with fits of \"groupedData\" objects", sys.call()[[1L]]), domain = "R-nlme")
667,668c661
<             stop(gettextf("%s and %s must have the same group levels", c1, c2),
<                  domain = NA)
---
>             stop(gettextf("%s and %s must have the same group levels", sQuote(c1), sQuote(c2)), domain = "R-nlme")
716c709
<     lab <- "Fitted values"
---
>     lab <- gettext("Fitted values", domain = "R-nlme")
766c759
<         attr(val[["coef"]], "label") <- "Coefficients:"
---
>         attr(val[["coef"]], "label") <- gettext("Coefficients:", domain = "R-nlme")
783c776
<                               label = "Residual standard error:")
---
>                               label = gettext("Residual standard error:", domain = "R-nlme"))
788c781
<                                             label = "Fixed Residual standard error:")
---
>                                             label = gettext("Fixed Residual standard error:", domain = "R-nlme"))
792,793c785
<                 stop(gettextf("cannot get confidence intervals on var-cov components: %s",
<                               aV), domain = NA)
---
>                 stop(gettextf("cannot get confidence intervals on var-cov components: %s", aV), domain = "R-nlme")
827c819
< 			  label = "Residual standard error:")
---
> 			  label = gettext("Residual standard error:", domain = "R-nlme"))
838,839c830,831
<                            corStruct = "Correlation structure:",
<                            varStruct = "Variance function:",
---
>                            corStruct = gettext("Correlation structure:", domain = "R-nlme"),
>                            varStruct = gettext("Variance function:", domain = "R-nlme"),
910,913c902,904
<                                       "level %s not allowed for %s",
<                                       "levels %s not allowed for %s"),
<                              paste(levs[wch], collapse = ",")),
<                      domain = NA)
---
>                                       "level %s is not allowed for %s",
>                                       "levels %s are not allowed for %s", domain = "R-nlme"),
>                              paste(levs[wch], collapse = ", ")), domain = NA)
934c925
<     lab <- "Predicted values"
---
>     lab <- gettext("Predicted values", domain = "R-nlme")
944,945c935
<     cat(paste0("Approximate ", attr(x, "level") * 100,
<                "% confidence intervals\n"))
---
>     cat(gettextf("Approximate %s %% confidence intervals", attr(x, "level") * 100, domain = "R-nlme"), "\n", sep = "")
964c954,957
<         cat("Generalized nonlinear least squares fit\n")
---
>         cat(gettext("Generalized nonlinear least squares fit", domain = "R-nlme"), "\n", sep = "")
>     } else {
>        if(x$method == "REML") {
>         cat(gettext("Generalized least squares fit by REML", domain = "R-nlme"), "\n", sep = "")
966,967c959
<         cat("Generalized least squares fit by ")
<         cat(if(x$method == "REML") "REML\n" else "maximum likelihood\n")
---
>         cat(gettext("Generalized least squares fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
969,970c961,963
<     cat("  Model:", deparse(mCall$model), "\n")
<     cat("  Data:", deparse( mCall$data ), "\n")
---
>     }
>     cat(gettext("  Model: ", domain = "R-nlme"), deparse(mCall$model), "\n", sep = "")
>     cat(gettext("  Data: ", domain = "R-nlme"), deparse( mCall$data ), "\n", sep = "")
972c965
<         cat("  Subset:", deparse(asOneSidedFormula(mCall$subset)[[2]]),"\n")
---
>         cat(gettext("  Subset: ", domain = "R-nlme"), deparse(asOneSidedFormula(mCall$subset)[[2]]), "\n", sep = "")
975c968,971
<         cat("  Log-likelihood: ", format(x$logLik), "\n", sep = "")
---
>         cat(gettext("  Log-likelihood: ", domain = "R-nlme"), format(x$logLik), "\n", sep = "")
>     } else {
>       if(x$method == "REML") {
>         cat(gettext("  Log-restricted-likelihood: ", domain = "R-nlme"), format(x$logLik), "\n", sep = "")
977,978c973,974
<         cat("  Log-", if(x$method == "REML") "restricted-" else "",
<             "likelihood: ", format(x$logLik), "\n", sep = "")
---
>         cat(gettext("  Log-likelihood: ", domain = "R-nlme"), format(x$logLik), "\n", sep = "")
>       }
980c976
<     cat("\nCoefficients:\n")
---
>     cat("\n", gettext("Coefficients:", domain = "R-nlme"), "\n", sep = "")
986,988c982,983
<     cat("Degrees of freedom:", dd[["N"]],"total;",dd[["N"]] - dd[["p"]],
<         "residual\n")
<     cat("Residual standard error:", format(x$sigma),"\n")
---
>     cat(gettextf("Degrees of freedom: %s total; %s residual", dd[["N"]], dd[["N"]] - dd[["p"]], domain = "R-nlme"), "\n", sep = "")
>     cat(gettext("Residual standard error: ", domain = "R-nlme"), format(x$sigma), "\n", sep = "")
1001c996
<         cat("Generalized nonlinear least squares fit\n")
---
>         cat(gettext("Generalized nonlinear least squares fit", domain = "R-nlme"), "\n", sep = "")
1003,1004c998,1002
<         cat("Generalized least squares fit by ")
<         cat(if(x$method == "REML") "REML\n" else "maximum likelihood\n")
---
>        if(x$method == "REML") {
>         cat(gettext("Generalized least squares fit by REML", domain = "R-nlme"), "\n", sep = "")
>        } else {
>         cat(gettext("Generalized least squares fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
>        }
1006,1007c1004,1005
<     cat("  Model:", deparse(mCall$model), "\n")
<     cat("  Data:", deparse( mCall$data ), "\n")
---
>     cat(gettext("  Model: ", domain = "R-nlme"), deparse(mCall$model), "\n", sep = "")
>     cat(gettext("  Data: ", domain = "R-nlme"), deparse( mCall$data ), "\n", sep = "")
1009c1007
<         cat("  Subset:", deparse(asOneSidedFormula(mCall$subset)[[2]]),"\n")
---
>         cat(gettext("  Subset: ", domain = "R-nlme"), deparse(asOneSidedFormula(mCall$subset)[[2]]), "\n", sep = "")
1014c1012
<     if (verbose) { cat("Convergence at iteration:",x$numIter,"\n") }
---
>     if (verbose) { cat(gettext("Convergence at iteration: ", domain = "R-nlme"), x$numIter, "\n", sep = "") }
1019c1017
<     cat("\nCoefficients:\n")
---
>     cat("\n", gettext("Coefficients:", domain = "R-nlme"), "\n", sep = "")
1034c1032
<         print(corr, title = "\n Correlation:", ...)
---
>         print(corr, title = paste("\n ", gettext("Correlation:", domain = "R-nlme"), collapse = ""), ...)
1036c1034
<     cat("\nStandardized residuals:\n")
---
>     cat("\n", gettext("Standardized residuals:", domain = "R-nlme"), "\n", sep = "")
1039,1041c1037,1038
<     cat("Residual standard error:", format(x$sigma),"\n")
<     cat("Degrees of freedom:", dd[["N"]],"total;", dd[["N"]] - dd[["p"]],
<         "residual\n")
---
>     cat(gettext("Residual standard error: ", domain = "R-nlme"), format(x$sigma), "\n", sep = "")
>     cat(gettextf("Degrees of freedom: %s total; %s residual", dd[["N"]], dd[["N"]] - dd[["p"]], domain = "R-nlme"), "\n", sep = "")
1052c1049
<         lab <- "Standardized residuals"
---
>         lab <- gettext("Standardized residuals", domain = "R-nlme")
1057c1054
<                 lab <- "Normalized residuals"
---
>                 lab <- gettext("Normalized residuals", domain = "R-nlme")
1061c1058
<         lab <- "Residuals"
---
>         lab <- gettext("Residuals", domain = "R-nlme")
1120c1117
< 	stop("need an object with call component")
---
> 	stop("an object with 'call' component is required")
1242c1239
<                 stop("'nint' is not consistent with 'breaks'")
---
>                 stop(gettextf("'%s' is not consistent with '%s'", "nint", "breaks"))
1273c1270
<     row.names(val) <- 1:nrow(val)
---
>     row.names(val) <- seq_len(nrow(val))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/gnls.R Recommended/nlme/R/gnls.R
68c68
<     stop("'object' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "model", dQuote("formula")))
70c70
<     stop("object formula must be of the form \"resp ~ pred\"")
---
>     stop("model formula must be of the form \"resp ~ pred\"")
82c82
<           stop("'data' must be given explicitly to use 'nls' to get initial estimates")
---
>           stop(gettextf("'%s' argument must be given explicitly to use %s function to get initial estimates", "data", sQuote("nls()")))
123c123
<       stop ("'params' must be a formula or list of formulae")
---
>       stop(gettextf("'%s' argument must be a formula or list of formulae", "params"))
125c125
<       stop ("formulae in 'params' must be of the form \"parameter ~ expr\"")
---
>       stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "params"))
127c127
<       stop ("formulae in 'params' must be of the form \"parameter ~ expr\"")
---
>       stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "params"))
373c373
<             cat("\n**Iteration", numIter)
---
>             cat("\n**", gettextf("Iteration %d", numIter, domain = "R-nlme"), sep = "")
375c375
<             cat("GLS step: Objective:", format(optRes$value))
---
>             cat(gettext("GLS step: Objective: ", domain = "R-nlme"), format(optRes$value), sep = "")
406c406
< 	       NAOK = TRUE)[c("thetaNLS", "settings", "additional")]
---
> 	       NAOK = TRUE)
409c409
<       msg <- "step halving factor reduced below minimum in NLS step"
---
>       msg <- gettext("step halving factor reduced below minimum in NLS step", domain = "R-nlme")
411c411
<         warning(msg)
---
>         warning(msg, domain = NA)
413c413
<       } else stop(msg)
---
>       } else stop(msg, domain = NA)
423,425c423,425
<       cat("\nNLS step: RSS = ", format(work$settings[6]), "\n model parameters:")
<       for (i in 1:pLen) cat(format(signif(spar[i]))," ")
<       cat("\n iterations:",work$settings[5],"\n")
---
>       cat("\n", gettextf("NLS step: RSS = %s", format(work$settings[6]), domain = "R-nlme"), "\n ", gettext("model parameters:", domain = "R-nlme"), sep = "")
>       for (i in seq_len(pLen)) cat(format(signif(spar[i]))," ")
>       cat("\n ", gettext("iterations: ", domain = "R-nlme"), work$settings[5], "\n", sep = "")
431c431
<     aConv <- c(max(conv[1:pLen]))
---
>     aConv <- c(max(conv[seq_len(pLen)]))
434c434
<       conv <- conv[-(1:pLen)]
---
>       conv <- conv[-(seq_len(pLen))]
444c444
<       cat("\nConvergence:\n")
---
>       cat("\n", gettext("Convergence:", domain = "R-nlme"), "\n", sep = "")
455c455
<       msg <- "maximum number of iterations reached without convergence"
---
>       msg <- gettext("maximum number of iterations reached without convergence", domain = "R-nlme")
457c457
< 	warning(msg)
---
> 	warning(msg, domain = NA)
459c459
<       } else stop(msg)
---
>       } else stop(msg, domain = NA)
465c465
<   auxRes <- ww[NReal * pLen + (1:NReal)]
---
>   auxRes <- ww[NReal * pLen + seq_len(NReal)]
479c479
<   varBeta <- qr(c.L$Xy[ , 1:pLen, drop = FALSE])
---
>   varBeta <- qr(c.L$Xy[ , seq_len(pLen), drop = FALSE])
511c511
<     else "Approximate variance-covariance matrix not available"
---
>     else gettext("Approximate variance-covariance matrix not available", domain = "R-nlme")
610c610
<       "Non-positive definite approximate variance-covariance"
---
>       gettext("Non-positive definite approximate variance-covariance", domain = "R-nlme")
719,720c719,720
<                                 "level %s not allowed for %s",
<                                 "levels %s not allowed for %s"),
---
>                                 "level %s is not allowed for %s",
>                                 "levels %s are not allowed for %s", domain = "R-nlme"),
776c776
<   lab <- "Predicted values"
---
>   lab <- gettext("Predicted values", domain = "R-nlme")
790c790
< 	stop("need an object with call component")
---
> 	stop("an object with 'call' component is required")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/groupedData.R Recommended/nlme/R/groupedData.R
32c32
<     stop("first argument to 'groupedData' must be a two-sided formula")
---
>     stop(gettextf("first argument passed to %s function must be a two-sided formula", sQuote("GroupedData()")))
53c53
<     stop("first argument to 'nfGroupedData' must be a two-sided formula")
---
>     stop(gettextf("first argument passed to %s function must be a two-sided formula", sQuote("nfGroupedData()")))
70c70
<       stop("second argument to 'groupedData' must inherit from data.frame")
---
>       stop("second argument passed to 'groupedData()' function must inherit from \"data.frame\"")
153c153
<     stop("first argument to 'nmGroupedData' must be a two-sided formula")
---
>     stop(gettextf("first argument passed to %s function must be a two-sided formula", sQuote("nmGroupedData()")))
179c179
<       stop("second argument to 'groupedData' must inherit from data.frame")
---
>       stop("second argument passed to 'groupedData()' function must inherit from \"data.frame\"")
230c230
<       stop("'subset' must be a list")
---
>       stop(gettextf("'%s' argument must be a list", "subset"))
251,252c251
<       stop(gettextf("undefined display level %s for %s",
<                     displayLevel, sQuote(substitute(object))), domain = NA)
---
>       stop(gettextf("undefined display level %s for %s", displayLevel, sQuote(substitute(object))), domain = "R-nlme")
277,278c276
<         stop(gettextf("undefined collapsing level %s for %s",
<                       collapseLevel, sQuote(substitute(object))), domain = NA)
---
>         stop(gettextf("undefined collapsing level %s for %s", collapseLevel, sQuote(substitute(object))), domain = "R-nlme")
298c296
<           stop("'preserve' must be a two-sided formula")
---
>           stop(gettextf("'%s' argument must be a two-sided formula", "preserve"))
565c563
<   cat("Grouped Data: ")
---
>   cat(gettext("Grouped Data: ", domain = "R-nlme"))
631c629
<     stop("'asTable' cannot be used with multilevel grouped data")
---
>     stop("'asTable()' function cannot be used with multilevel grouped data")
635c633
<     stop("'asTable' can only be used with balanced 'groupedData' objects")
---
>     stop("'asTable()' function can only be used with balanced object of class \"groupedData\"")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/lmList.R Recommended/nlme/R/lmList.R
38c38
<                          "%d times caught the same error in %s: %s"),
---
>                          "%d times caught the same error in %s: %s", domain = "R-nlme"),
41,44c41,44
<         paste(gettextf(
<           "%d errors caught in %s.  The error messages and their frequencies are",
<           sum(tt), e.call),
<           paste(capture.output(sort(tt)), collapse="\n"), sep="\n")
---
>         gettextf(
>           "%d errors caught in %s. The error messages and their frequencies are\n%s",
>           sum(tt), e.call,
>           paste(capture.output(sort(tt)), collapse="\n"), domain = "R-nlme")
94c94
<       stop ("'data' must be a \"groupedData\" object if 'groups' argument is missing")
---
>       stop(gettextf("'%s' argument must be an object of class %s if 'groups' argument is missing", "data", dQuote("groupedData")))
135,136c135
<       stop(gettextf("'data' in %s call must evaluate to a data frame",
<                      sQuote(substitute(object))), domain = NA)
---
>       stop(gettextf("'data' in %s call must evaluate to a data frame", sQuote(substitute(object))), domain = "R-nlme")
140,141c139
<         stop(gettextf("%s without \"primary\" can only be used with fits of \"groupedData\" objects",
<                       sys.call()[[1]]), domain = NA)
---
>         stop(gettextf("%s without \"primary\" can only be used with fits of \"groupedData\" objects", sys.call()[[1]]), domain = "R-nlme")
255c253
<         stop("nonexistent groups requested in 'subset'")
---
>         stop("nonexistent groups requested in 'subset' argument")
260c258
<           stop("nonexistent groups requested in 'subset'")
---
>           stop("nonexistent groups requested in 'subset' argument")
263c261
<         stop("'subset' can only be character or integer")
---
>         stop(gettextf("'%s' argument can only be character or integer", "subset"))
285c283
<   lab <- "Fitted values"
---
>   lab <- gettext("Fitted values", domain = "R-nlme")
402c400
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
405c403
<     stop("'form' must be a one-sided formula")
---
>     stop(gettextf("'%s' argument must be a one-sided formula", "form"))
421,422c419,420
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
486c484
< 		 stop("'id' must be between 0 and 1")
---
> 		 stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
494c492
< 	     stop("'id' can only be a formula or numeric")
---
>              stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
509c507
< 	  stop("'idLabels' of incorrect length")
---
>           stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
513c511
< 	stop("'idLabels' can only be a formula or a vector")
---
> 	stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
661c659
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
678,679c676,677
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
756c754
< 		 stop("'id' must be between 0 and 1")
---
> 		 stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
761c759
< 	     stop("'id' can only be a formula or numeric")
---
>              stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
773c771
< 	  stop("'idLabels' of incorrect length")
---
>           stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
777c775
< 	stop("'idLabels' can only be a formula or a vector")
---
> 	stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
881c879
<       stop("nonexistent group requested in 'subset'")
---
>       stop("nonexistent groups requested in 'subset' argument")
967c965
<       attr(val, "label") <- "Predicted values"
---
>       attr(val, "label") <- gettext("Predicted values", domain = "R-nlme")
989c987
<   cat("Call:\n")
---
>   cat(gettext("Call:", domain = "R-nlme"), "\n", sep = "")
991,993c989
<   cat("  Model:", deparse(getResponseFormula(form)[[2]]),
<       "~", c_deparse(getCovariateFormula(form)[[2]]), "|",
<       deparse(getGroupsFormula(x)[[2]]), "\n")
---
>   cat(gettext("  Model: ", domain = "R-nlme"), deparse(getResponseFormula(form)[[2]]), " ~ ", c_deparse(getCovariateFormula(form)[[2]]), " | ", deparse(getGroupsFormula(x)[[2]]), "\n", sep = "")
995c991
<     cat(" Level:", mCall$level, "\n")
---
>     cat(gettext(" Level: ", domain = "R-nlme"), mCall$level, "\n", sep = "")
997,998c993,994
<   cat("   Data:", deparse(mCall$data),"\n\n")
<   cat("Coefficients:\n")
---
>   cat(gettext("   Data: ", domain = "R-nlme"), deparse(mCall$data), "\n\n", sep = "")
>   cat(gettext("Coefficients:", domain = "R-nlme"), "\n", sep = "")
1005,1007c1001,1002
<     cat("Degrees of freedom: ", length(unlist(lapply(x, fitted))),
< 	" total; ", dfRes, " residual\n", sep = "")
<     cat("Residual standard error:", format(RSE))
---
>     cat(gettextf("Degrees of freedom: %s total; %s residual", length(unlist(lapply(x, fitted))), dfRes, domain = "R-nlme"), "\n", sep = "")
>     cat(gettext("Residual standard error: ", domain = "R-nlme"), format(RSE), sep = "")
1015c1010
<   cat("Call:\n")
---
>   cat(gettext("Call:", domain = "R-nlme"), "\n", sep = "")
1017,1019c1012,1013
<   cat("  Model:", deparse(getResponseFormula(form)[[2]]),
<       "~", c_deparse(getCovariateFormula(form)[[2]]), "|",
<       deparse(attr(x, "groupsForm")[[2]]), "\n")
---
>   cat(gettext("  Model: ", domain = "R-nlme"), deparse(getResponseFormula(form)[[2]]),
>       " ~ ", c_deparse(getCovariateFormula(form)[[2]]), " | ", deparse(attr(x, "groupsForm")[[2]]), "\n", sep = "")
1021c1015
<     cat(" Level:", x$call$level, "\n")
---
>     cat(gettext(" Level: ", domain = "R-nlme"), x$call$level, "\n", sep = "")
1023,1024c1017,1018
<   cat("   Data:", deparse(x$call$data),"\n\n")
<   cat("Coefficients:\n")
---
>   cat(gettext("   Data: ", domain = "R-nlme"), deparse(x$call$data), "\n\n", sep = "")
>   cat(gettext("Coefficients:", domain = "R-nlme"), "\n", sep = "")
1031,1032c1025
<     cat("Residual standard error:", format(x$RSE), "on",
< 	x$df.residual, "degrees of freedom\n")
---
>     cat(gettextf("Residual standard error: %s on %s degrees of freedom", format(x$RSE), x$df.residual, domain = "R-nlme"), "\n", sep = "")
1045c1038
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
1060,1061c1053,1054
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
1078,1079c1071,1072
<     else if (!is.null(labs) && ((labs == "Standardized residuals") ||
<                                 (substr(labs, 1, 9) == "Residuals")))
---
>     else if (!is.null(labs) && ((labs == gettext("Standardized residuals", domain = "R-nlme")) ||
>                            (labs == gettext("Residuals", domain = "R-nlme"))))
1084c1077
<   if (is.null(args$ylab)) args$ylab <- "Quantiles of standard normal"
---
>   if (is.null(args$ylab)) args$ylab <- gettext("Quantiles of standard normal", domain = "R-nlme")
1098c1091
<                    stop("'id' must be between 0 and 1")
---
> 		   stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
1104c1097
<                stop("'id' can only be a formula or numeric")
---
>                stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
1116c1109
<             stop("'idLabels' of incorrect length")
---
>             stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
1120c1113
<           stop("'idLabels' can only be a formula or a vector")
---
> 	  stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
1151c1144
<                    stop("'id' must be between 0 and 1")
---
> 		   stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
1157c1150
<                stop("'id' can only be a formula or numeric")
---
>                stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
1172c1165
<             stop("'idLabels' of incorrect length")
---
>             stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
1176c1169
<           stop("'idLabels' can only be a formula or a vector")
---
> 	  stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
1251c1244
<     attr(val, "label") <- "Standardized random effects"
---
>     attr(val, "label") <- gettext("Standardized random effects", domain = "R-nlme")
1253c1246
<     attr(val, "label") <- "Random effects"
---
>     attr(val, "label") <- gettext("Random effects", domain = "R-nlme")
1272c1265
<         stop("nonexistent groups requested in 'subset'")
---
>         stop("nonexistent groups requested in 'subset' argument")
1275c1268
<         stop("nonexistent groups requested in 'subset'")
---
>         stop("nonexistent groups requested in 'subset' argument")
1277c1270
<         stop("'subset' can only be character or integer")
---
>         stop(gettextf("'%s' argument can only be character or integer", "subset"))
1313c1306
<       lab <- "Residuals"
---
>       lab <- gettext("Residuals", domain = "R-nlme")
1316c1309
<     else "Standardized residuals"
---
>     else lab <- gettext("Standardized residuals", domain = "R-nlme")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/lme.R Recommended/nlme/R/lme.R
67c67
<     stop("can only fit \"lmList\" objects with single grouping variable")
---
>     stop(gettextf("can only fit objects of class %s with single grouping variable", dQuote("lmList")))
72c72
<     warning("'lme.lmList' will redefine 'data'")
---
>     warning("'lme.lmList()' function will redefine 'data' argument")
107c107
<     stop("can only fit \"lmList\" objects with single grouping variable")
---
>     stop(gettextf("can only fit objects of class %s with single grouping variable", dQuote("lmList")))
112c112
<       warning("initial value for \"reStruct\" overwritten in 'lme.lmList'")
---
>       warning(gettextf("initial value for 'reStruct' overwritten in %s function", sQuote("lme.lmList()")))
157c157
<     stop("\nfixed-effects model must be a formula of the form \"resp ~ pred\"")
---
>     stop("fixed-effects model must be a formula of the form \"resp ~ pred\"")
170c170
<           stop("incompatible lengths for 'random' and grouping factors")
---
>           stop("incompatible lengths for 'random' argument and grouping factors")
174c174
<         for(i in 1:Q) randL[[i]] <- random
---
>         for(i in seq_len(Q)) randL[[i]] <- random
198c198
<           stop("incompatible formulas for groups in 'random' and 'correlation'")
---
>           stop("incompatible formulas for groups in 'random' and 'correlation' arguments")
205c205
<         stop("incompatible formulas for groups in 'random' and 'correlation'")
---
>         stop("incompatible formulas for groups in 'random' and 'correlation' arguments")
292,293c292
<     warning(gettextf("fewer observations than random effects in all level %s groups",
<                      Q), domain = NA)
---
>     warning(gettextf("fewer observations than random effects in all level %s groups", Q), domain = "R-nlme")
346c345
<           stop(msg, domain = NA)
---
>           stop(msg, domain = "R-nlme")
348c347
<           warning(msg, domain = NA)
---
>           warning(msg, domain = "R-nlme")
372c371
<         warning(msg, domain = NA)
---
>         warning(msg, domain = "R-nlme")
375c374
<         stop(msg, domain = NA)
---
>         stop(msg, domain = "R-nlme")
416c415
<       "Approximate variance-covariance matrix not available"
---
>       gettext("Approximate variance-covariance matrix not available", domain = "R-nlme")
617c616
<     "Non-positive definite approximate variance-covariance"
---
>     gettext("Non-positive definite approximate variance-covariance", domain = "R-nlme")
766c765
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
788c787
<   for(i in 1:Q) lastBlock[[i]] <- c(strSizes[i, -N], strRows)
---
>   for(i in seq_len(Q)) lastBlock[[i]] <- c(strSizes[i, -N], strRows)
790c789
<   for(i in 1:Q) lastBlock[[i]] <- maxStr[as.logical(lastBlock[[i]])]
---
>   for(i in seq_len(Q)) lastBlock[[i]] <- maxStr[as.logical(lastBlock[[i]])]
802c801
<        DmOff = c(0, cumsum(ncols^2))[1:(Q+2)],# offsets into DmHalf array by level
---
>        DmOff = c(0, cumsum(ncols^2))[seq_len(Q+2)],# offsets into DmHalf array by level
835c834
<                   nn[1:N] <- n + 1L - 1:N
---
>                   nn[seq_len(N)] <- n + 1L - seq_len(N)
837,838c836,837
<                   for(i in 1:N) {
<                     tt[i] <- sum(el[1:(n-i+1)] * el[i:n])
---
>                   for(i in seq_len(N)) {
>                     tt[i] <- sum(el[seq_len(n-i+1)] * el[i:n])
864c863
<       stop("object must inherit from class \"lme\" ")
---
>       stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("lme")))
879c878
<       for(i in 1:nTerms) {
---
>       for(i in seq_len(nTerms)) {
901,902c900
<             stop(gettextf("'Terms' must be between 1 and %d", nTerms),
<                  domain = NA)
---
>             stop(gettextf("'%s' argument must be between %d and %d", "Terms", 1, nTerms), domain = "R-nlme")
908,909c906,907
<                                     "term %s not matched",
<                                     "terms %s not matched"),
---
>                                     "term %s was not matched",
>                                     "terms %s were not matched", domain = "R-nlme"),
922c920
<           paste("F-test for:",paste(names(assign[Terms]),collapse=", "),"\n")
---
>           paste(gettext("F-test for: ", domain = "R-nlme"), paste(names(assign[Terms]), collapse = ", "), "\n", sep = "")
932c930
<                                 "'L' must have at most %d columns"),
---
>                                 "'L' must have at most %d columns", domain = "R-nlme"),
939c937
<           L0[, 1:ncolL] <- L
---
>           L0[, seq_len(ncolL)] <- L
943,944c941,942
<                                   "effect %s not matched",
<                                   "effects %s not matched"),
---
>                                   "effect %s was not matched",
>                                   "effects %s were not matched", domain = "R-nlme"),
952c950
<         rownames(L) <- if(is.null(dmsL1)) 1:nrowL else dmsL1[noZeroRowL]
---
>         rownames(L) <- if(is.null(dmsL1)) seq_len(nrowL) else dmsL1[noZeroRowL]
959c957
<         lab <- "F-test for linear combination(s)\n"
---
>         lab <- paste(gettext("F-test for linear combinations", domain = "R-nlme"), "\n", sep = "")
991c989
<            domain=NA)
---
>            domain="R-nlme")
1041c1039
<                       Model = 1:rt,
---
>                       Model = seq_len(rt),
1084c1082
<                   sQuote(substitute(object))), domain = NA)
---
>                   sQuote(substitute(object))), domain = "R-nlme")
1187c1185
<   for (i in 1:level) {
---
>   for (i in seq_len(level)) {
1208c1206
<   attr(effs, "label") <- "Coefficients"
---
>   attr(effs, "label") <- gettext("Coefficients", domain = "R-nlme")
1226c1224
<                             "nonexistent levels %s"),
---
>                             "nonexistent levels %s", domain = "R-nlme"),
1242c1240
<     lab <- "Fitted values"
---
>     lab <- gettext("Fitted values", domain = "R-nlme")
1297c1295
<     attr(vfix, "label") <- "Fixed effects:"
---
>     attr(vfix, "label") <- gettext("Fixed effects:", domain = "R-nlme")
1303c1301
<                     aV, "which = \"fixed\""), domain = NA)
---
>                     aV, "which = \"fixed\""), domain = "R-nlme")
1334c1332
<     attr(vsig, "label") <- "Within-group standard error:"
---
>     attr(vsig, "label") <- gettext("Within-group standard error:", domain = "R-nlme")
1348c1346
<       attr(vsig, "label") <- "Within-group standard error:"
---
>       attr(vsig, "label") <- gettext("Within-group standard error:", domain = "R-nmle")
1368c1366
<     for(i in 1:3) {                     # re-express intervals in constrained pars
---
>     for(i in seq_len(3)) {                     # re-express intervals in constrained pars
1394,1397c1392,1395
<                reStruct = "Random Effects:",
<                corStruct = "Correlation structure:",
<                varStruct = "Variance function:",
<                paste0(i,":"))
---
>                reStruct = gettext("Random effects:", domain = "R-nlme"),
>                corStruct = gettext("Correlation structure:", domain = "R-nlme"),
>                varStruct = gettext("Variance function:", domain = "R-nlme"),
>                paste(i,":",sep=""))
1442c1440
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
1445c1443
<     stop("'form' must be a one-sided formula")
---
>     stop(gettextf("'%s' argument must be a one-sided formula", "form"))
1461,1462c1459,1460
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
1525c1523
<                  stop("'id' must be between 0 and 1")
---
>                  stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
1537c1535
<              stop("'id' can only be a formula or numeric")
---
>              stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
1542c1540
<         stop("covariate must have a level attribute when 'id' is a formula")
---
>         stop(gettextf("covariate must have a level attribute when '%s' argument is a formula", "id"))
1555c1553
<           stop("'idLabels' of incorrect length")
---
>           stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
1559c1557
<         stop("'idLabels' can only be a formula or a vector")
---
>         stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
1565c1563
<         stop("covariate must have a level attribute when 'idLabels' is a formula")
---
>         stop(gettextf("covariate must have a level attribute when '%s' argument is a formula", "idLabels"))
1698,1699c1696,1697
<                               "%s not available for plotting",
<                               "%s not available for plotting"),
---
>                               "%s is not available for plotting",
>                               "%s are not available for plotting", domain = "R-nlme"),
1737c1735
<       stop("'form' must be a formula when not NULL")
---
>       stop(gettextf("'%s' argument must be a formula when not NULL", "form"))
1747,1748c1745
<       stop(gettextf("%s is not a valid effect name", sQuote(reName)),
<            domain = NA)
---
>       stop(gettextf("%s is not a valid effect name", sQuote(reName)), domain = "R-nlme")
1756,1757c1753,1754
<                             "%s not available for plotting",
<                             "%s not available for plotting"),
---
>                             "%s is not available for plotting",
>                             "%s are not available for plotting", domain = "R-nlme"),
1770c1767
<     for(i in 1:nV) {
---
>     for(i in seq_len(nV)) {
1947,1948c1944,1945
<                               "level %s not allowed for %s",
<                               "levels %s not allowed for %s"),
---
>                               "level %s is not allowed for %s",
>                               "levels %s are not allowed for %s", domain = "R-nlme"),
1979c1976
<     attr(val, "label") <- "Predicted values"
---
>     attr(val, "label") <- gettext("Predicted values", domain = "R-nlme")
2021c2018
<     lab <- "Predicted values"
---
>     lab <- gettext("Predicted values", domain = "R-nlme")
2049c2046
<       cat("Call:\n")
---
>       cat(gettext("Call:", domain = "R-nlme"), "\n", sep = "")
2051c2048
<       for(i in 1:rt) {
---
>       for(i in seq_len(rt)) {
2053c2050
<         cat(" ",as.character(x[i,"call"]),"\n")
---
>         cat(" ", as.character(x[i,"call"]), "\n", sep = "")
2084c2081
<   cat(paste0("Approximate ", attr(x,"level") *100, "% confidence intervals\n"))
---
>   cat(gettextf("Approximate %s %% confidence intervals", attr(x, "level") * 100,  domain = "R-nlme"), "\n", sep = "")
2090c2087
<         cat("  Level:", j, "\n")
---
>         cat(gettext("  Level: ",  domain = "R-nlme"), j, "\n", sep = "")
2105,2107c2102,2107
<     cat( "Nonlinear mixed-effects model fit by " )
<     cat( if(x$method == "REML") "REML\n" else "maximum likelihood\n")
<     cat("  Model:", deparse(x$call$model),"\n")
---
>     if(x$method == "REML") {
>      cat(gettext("Nonlinear mixed-effects model fit by REML", domain = "R-nlme"), "\n", sep = "")
>     } else {
>      cat(gettext("Nonlinear mixed-effects model fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
>     }
>     cat(gettext("  Model: ", domain = "R-nlme"), deparse(x$call$model), "\n", sep = "")
2109,2110c2109,2113
<     cat( "Linear mixed-effects model fit by " )
<     cat( if(x$method == "REML") "REML\n" else "maximum likelihood\n")
---
>     if(x$method == "REML") {
>      cat(gettext("Linear mixed-effects model fit by REML", domain = "R-nlme"), "\n", sep = "")
>     } else {
>      cat(gettext("Linear mixed-effects model fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
>     }
2112c2115
<   cat("  Data:", deparse( x$call$data ), "\n")
---
>   cat(gettext("  Data: ", domain = "R-nlme"), deparse( x$call$data ), "\n", sep = "")
2114c2117,2122
<     cat("  Subset:", deparse(asOneSidedFormula(x$call$subset)[[2L]]),"\n")
---
>     cat(gettext("  Subset: ", domain = "R-nlme"), deparse(asOneSidedFormula(x$call$subset)[[2L]]), "\n", sep = "")
>   }
>   if(x$method == "REML") {
>    cat(gettext("  Log-restricted-likelihood: ", domain = "R-nlme"), format(x$logLik), "\n", sep = "")
>   } else {
>    cat(gettext("  Log-likelihood: ", domain = "R-nlme"), format(x$logLik), "\n", sep = "")
2116,2117d2123
<   cat("  Log-", if(x$method == "REML") "restricted-" else "",
<       "likelihood: ", format(x$logLik), "\n", sep = "")
2119c2125
<   cat("  Fixed:",
---
>   cat(gettext("  Fixed: ", domain = "R-nlme"),
2128,2129c2134,2135
<   cat("Number of Observations:", dd[["N"]])
<   cat("\nNumber of Groups: ")
---
>   cat(gettext("Number of Observations: ", domain = "R-nlme"), dd[["N"]], "\n", sep = "")
>   cat(gettext("Number of Groups: ", domain = "R-nlme"))
2151c2157
<       cat("Level:", attr(x, "grpNames")[i],"\n")
---
>       cat(gettext("Level: ", domain = "R-nlme"), attr(x, "grpNames")[i], "\n", sep = "")
2164,2166c2170,2175
<     cat( "Nonlinear mixed-effects model fit by " )
<     cat( if(x$method == "REML") "REML\n" else "maximum likelihood\n")
<     cat("  Model:", deparse(x$call$model),"\n")
---
>     if(x$method == "REML") {
>      cat(gettext("Nonlinear mixed-effects model fit by REML", domain = "R-nlme"), "\n", sep = "")
>     } else {
>      cat(gettext("Nonlinear mixed-effects model fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
>     }
>     cat(gettext("  Model: ", domain = "R-nlme"), deparse(x$call$model), "\n", sep = "")
2168,2169c2177,2181
<     cat( "Linear mixed-effects model fit by " )
<     cat( if(x$method == "REML") "REML\n" else "maximum likelihood\n")
---
>     if(x$method == "REML") {
>      cat(gettext("Linear mixed-effects model fit by REML", domain = "R-nlme"), "\n", sep = "")
>     } else {
>      cat(gettext("Linear mixed-effects model fit by maximum likelihood", domain = "R-nlme"), "\n", sep = "")
>     }
2172c2184
<   cat(" Data:", deparse( x$call$data ), "\n")
---
>   cat(gettext(" Data: ", domain = "R-nlme"), deparse( x$call$data ), "\n", sep = "")
2174c2186
<     cat("  Subset:", deparse(asOneSidedFormula(x$call$subset)[[2L]]),"\n")
---
>     cat(gettext("  Subset: ", domain = "R-nlme"), deparse(asOneSidedFormula(x$call$subset)[[2L]]), "\n", sep = "")
2176,2178c2188,2189
<   print(data.frame(AIC = x$AIC, BIC = x$BIC, logLik = c(x$logLik),
<                    row.names = " "), ...)
<   if (verbose) { cat("Convergence at iteration:",x$numIter,"\n") }
---
>   print(data.frame(AIC = x$AIC, BIC = x$BIC, logLik = c(x$logLik), row.names = " "), ...)
>   if (verbose) { cat(gettext("Convergence at iteration: ", domain = "R-nlme"), x$numIter, "\n", sep = "") }
2182c2193
<   cat("Fixed effects: ")
---
>   cat(gettext("Fixed effects: ", domain = "R-nlme"))
2185c2196
<     cat(deparse(x$call$fixed), "\n")
---
>     cat(deparse(x$call$fixed), "\n", sep = "")
2204c2215
<     print(corr, title = " Correlation:", ...)
---
>     print(corr, title = gettext(" Correlation:", domain = "R-nlme"), ...)
2206c2217
<   cat("\nStandardized Within-Group Residuals:\n")
---
>   cat("\n", gettext("Standardized Within-Group Residuals:", domain = "R-nlme"), "\n", sep = "")
2208,2210c2219,2221
<   cat("\nNumber of Observations:",x$dims[["N"]])
<   cat("\nNumber of Groups: ")
<   Ngrps <- dd$ngrps[1:dd$Q]
---
>   cat("\n", gettext("Number of Observations: ", domain = "R-nlme"), x$dims[["N"]], sep = "")
>   cat("\n", gettext("Number of Groups: ", domain = "R-nlme"), sep = "")
>   Ngrps <- dd$ngrps[seq_len(dd$Q)]
2214c2225
<     sNgrps <- 1:lNgrps
---
>     sNgrps <- seq_len(lNgrps)
2233c2244
<   if (!inherits(form, "formula")) stop("'form' must be a formula")
---
>   if (!inherits(form, "formula")) stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
2249,2250c2260,2261
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
2264,2271c2275,2281
<   type <-
<     if (inherits(.x, "ranef.lme"))
<       "reff" # random effects
<     else if (!is.null(labs) && (labs == "Standardized residuals" ||
< 				labs == "Normalized residuals"   ||
< 				substr(labs, 1, 9) == "Residuals"))
<       "res" # residuals
<     else
---
>   if (inherits(.x, "ranef.lme")) {      # random effects
>     type <- "reff"
>   } else if (!is.null(labs) && ((labs == gettext("Standardized residuals", domain = "R-nlme")) ||
>                                 (labs == gettext("Normalized residuals", domain = "R-nlme")) ||
>                                 (labs == gettext("Residuals", domain = "R-nlme")))) {
>     type <- "res" # residuals
>   } else
2275c2285
<   if (is.null(args$ylab)) args$ylab <- "Quantiles of standard normal"
---
>   if (is.null(args$ylab)) args$ylab <- gettext("Quantiles of standard normal", domain = "R-nlme")
2290c2300
<                    stop("'Id' must be between 0 and 1")
---
>                    stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
2292c2302
<                  if (labs == "Normalized residuals") {
---
>                  if (labs == gettext("Normalized residuals", domain = "R-nlme")) {
2301c2311
<                stop("'id' can only be a formula or numeric")
---
>                stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
2313c2323
<             stop("'idLabels' of incorrect length")
---
>             stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
2317c2327
<           stop("'idLabels' can only be a formula or a vector")
---
>           stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
2348c2358
<                    stop("'id' must be between 0 and 1")
---
>                    stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
2354c2364
<                stop("'id' can only be a formula or numeric")
---
>                stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
2361d2370
<       idLabels <-
2363,2364c2372,2375
<           rep(row.names(.x), nc)
<         } else if (mode(idLabels) == "call") {
---
>         idLabels <- rep(row.names(.x), nc)
>       } else {
>         if (mode(idLabels) == "call") {
>           idLabels <-
2367,2371c2378,2385
<           if (length(idLabels <- unlist(idLabels)) != N)
<             stop("'idLabels' of incorrect length")
<           as.character(idLabels)
<         } else
<           stop("'idLabels' can only be a formula or a vector")
---
>           if (length(idLabels <- unlist(idLabels)) != N) {
>             stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
>           }
>           idLabels <- as.character(idLabels)
>         } else {
>           stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
>         }
>       }
2450,2451c2464
<         t(t(effects[[i]]) /
<           (object$sigma *
---
> 	t(t(effects[[i]]) / (object$sigma *
2466,2467c2479,2480
<     subset <- if (is.null(subset)) {  # nlme case
<                 eval(object$call[["naPattern"]])
---
>     if (is.null(subset)) {              # nlme case
>       subset <- eval(object$call[["naPattern"]])
2469c2482
<                 asOneSidedFormula(as.list(match.call())[["subset"]])
---
>       subset <- asOneSidedFormula(as.list(match.call())[["subset"]])
2482,2483c2495
<         data[, is.na(match(names(data), names(object$modelStruct$reStruct))),
<              drop = FALSE]
---
> 	data[, is.na(match(names(data), names(object$modelStruct$reStruct))), drop = FALSE]
2497,2504c2509,2519
<   structure(effects, class = c("ranef.lme", class(effects)),
<             label= if (standard)
<                      "Standardized random effects"
<                    else
<                      "Random effects",
<             level = max(level),
<             standardized = standard,
<             grpNames = grpNames)
---
>   attr(effects, "label") <-
>     if (standard) {
>       gettext("Standardized random effects", domain = "R-nlme")
>     } else {
>       gettext("Random effects", domain = "R-nlme")
>     }
>   attr(effects, "level") <- max(level)
>   attr(effects, "standardized") <- standard
>   attr(effects, "grpNames") <- grpNames
>   class(effects) <- c("ranef.lme", class(effects))
>   effects
2520c2535
<                             "nonexistent levels %s"),
---
>                               "nonexistent levels %s", domain = "R-nlme"),
2553,2555c2568,2572
<                if (!is.null(aux <- attr(object, "units")$y))
<                  paste("Residuals", aux)
<                else "Residuals"
---
>                lab <- gettext("Residuals", domain = "R-nlme")
>                if (!is.null(aux <- attr(object, "units")$y)) {
>                  lab <- paste(lab, aux)
>                }
>                lab
2557,2558c2574,2575
<              pearson = "Standardized residuals",
<              normalized = "Normalized residuals"
---
>              pearson = gettext("Standardized residuals", domain = "R-nlme"),
>              normalized = gettext("Normalized residuals", domain = "R-nlme")
2605c2622
<     stop("need an object with call component")
---
>     stop("an object with 'call' component is required")
2731c2748
<         stop("'nint' is not consistent with 'breaks'")
---
>         stop(gettextf("'%s' is not consistent with '%s'", "nint", "breaks"))
2769,2770c2786,2788
<   structure(val, class = c("Variogram", "data.frame"),
<             collapse = (collapse != "none"))
---
>   attr(val, "collapse") <- collapse != "none"
>   class(val) <- c("Variogram", "data.frame")
>   val
2816c2834
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
2881,2882c2899,2900
<   attr(val, "gradient") <- -aux[1 + (1:q)]
<   attr(val, "hessian") <- -array(aux[-(1:(q+1))], c(q, q))
---
>   attr(val, "gradient") <- -aux[1 + seq_len(q)]
>   attr(val, "hessian") <- -array(aux[-seq_len(q+1)], c(q, q))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/modelStruct.R Recommended/nlme/R/modelStruct.R
63c63
<       cat(paste(i, " parameters:\n"))
---
>       cat(gettextf("%s parameters:", i, domain = "R-nlme"), "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/newFunc.R Recommended/nlme/R/newFunc.R
137c137
<     stop("object must inherit from \"data.frame\"")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("data.frame")))
142c142
<       stop("'form' must be a formula")
---
>       stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
150c150
<       stop("only one level allowed in 'gapply'")
---
>       stop(gettextf("only one level allowed in %s function", sQuote("gapply")))
160,161c160,161
<                                        "%s not matched",
<                                        "%s not matched"),
---
>                                        "%s value was not matched",
>                                        "%s values were not matched", domain = "R-nlme"),
168,169c168
<                  stop(gettextf("'which' must be between 1 and %d",
<                                ncol(object)), domain = NA)
---
>                  stop(gettextf("'%s' argument must be between %d and %d", "which", 1, ncol(object)), domain = "R-nlme")
172c171
<            stop("'which' can only be character or integer")
---
>            stop(gettextf("'%s' argument can only be character or integer", "which"))
189c188
<     stop("formula(object) must return a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("formula")))
204c203
<     stop("'form' must be a two-sided formula")
---
>     stop(gettextf("'%s' argument must be a two-sided formula", "form"))
219c218
<     stop("object must inherit from \"data.frame\"")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("data.frame")))
223c222
<       stop("'form' must be a formula")
---
>       stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("fomrula")))
231c230
<       stop("only one level allowed in 'gsummary'")
---
>       stop(gettextf("only one level allowed in %s function", sQuote("gsummary")))
255c254
< 	stop("'FUN' can only be a function or a list of functions")
---
> 	stop(gettextf("'%s' argument can only be a function or a list of functions", "FUN"))
302c301
<     stop("object must inherit from class \"lmList\"")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("lmList")))
314c313
<     stop("no degrees of freedom for estimating std. dev.")
---
>     stop("no degrees of freedom for estimating standard deviation")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/newMethods.R Recommended/nlme/R/newMethods.R
16c16
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
52c52
<     stop( "data argument to \"data.frame\" method for 'getGroups' does not make sense" )
---
>     stop("'data' argument passed to \"data.frame\" method for 'getGroups()' does not make sense")
69c69
<       stop("'form' must have all components as formulas")
---
>       stop(gettextf("'%s' argument must have all components as formulae", "form"))
72c72
<     stop("'form' can only be a formula, or a list of formulas")
---
>     stop(gettextf("'%s' argument can only be a formula or a list of formulae", "form"))
90,92c90
<         stop(gettextf("level of %s does not match formula %s",
<                       level[aux], sQuote(deparse(form))),
<              domain = "NA")
---
>         stop(gettextf("level of %s does not match formula %s", level[aux], sQuote(deparse(form))), domain = "R-nlme")
97,99c95
<         stop(gettextf("level of %s does not match formula %s",
<                       level[aux], sQuote(deparse(form))),
<              domain = "NA")
---
>         stop(gettextf("level of %s does not match formula %s", level[aux], sQuote(deparse(form))), domain = "R-nlme")
123c119
<     stop("'form' must be a two-sided formula")
---
>     stop(gettextf("'%s' argument must be a two-sided formula", "form"))
136c132
<     stop("'form' argument must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "object", dQuote("formula")))
268c264
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
284,285c280,281
<                                 "%s not found in data",
<                                 "%s not found in data"),
---
>                                 "%s was not found in data",
>                                 "%s were not found in data", domain = "R-nlme"),
365c361
< 		 stop("'id' must be between 0 and 1")
---
> 		 stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
371c367
< 	     stop("'id' can only be a formula or numeric")
---
> 	     stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
383c379
< 	  stop("'idLabels' of incorrect length")
---
> 	  stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
387c383
< 	stop("'idLabels' can only be a formula or a vector")
---
> 	stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
470c466
<   function(x, alpha = 0, xlab = "Lag", ylab = "Autocorrelation",
---
>   function(x, alpha = 0, xlab = gettext("Lag", domain = "R-nlme"), ylab = gettext("Autocorrelation", domain = "R-nlme"),
598c594
<            xlab = "Distance", ylab = "Semivariogram", type = "p", ylim,
---
>            xlab = gettext("Distance", domain = "R-nlme"), ylab = gettext("Semivariogram", domain = "R-nlme"), type = "p", ylim,
663c659
<   function(x, title = " Correlation:", rdig = 3, ...)
---
>   function(x, title = gettext(" Correlation:", domain = "R-nlme"), rdig = 3, ...)
688c684
<     stop("'form' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "form", dQuote("formula")))
704,705c700,701
<                               "%s not found in data",
<                               "%s not found in data"),
---
>                               "%s was not found in data",
>                               "%s were not found in data", domain = "R-nlme"),
721,723c717,719
<   if (is.null(labs) || ((labs != "Standardized residuals") &&
<                         (labs != "Normalized residuals") &&
<                         (substring(labs, 1, 9) != "Residuals"))) {
---
>   if (is.null(labs) || ((labs != gettext("Standardized residuals", domain = "R-nlme")) &&
>                         (labs != gettext("Normalized residuals", domain = "R-nlme")) &&
>                         (labs != gettext("Residuals", domain = "R-nlme")))) {
727c723
<   if (is.null(args$ylab)) args$ylab <- "Quantiles of standard normal"
---
>   if (is.null(args$ylab)) args$ylab <- gettext("Quantiles of standard normal", domain = "R-nlme")
740c736
<                  stop("'id' must be between 0 and 1")
---
> 		 stop(gettextf("'%s' argument must be between %d and %d", "id", 0, 1))
742c738
<                if (labs == "Normalized residuals") {
---
>                if (labs == gettext("Normalized residuals", domain = "R-nlme")) {
751c747
<              stop("'id' can only be a formula or numeric")
---
>              stop(gettextf("'%s' argument can only be a formula or numeric", "id"))
763c759
<           stop("'idLabels' of incorrect length")
---
>           stop(gettextf("'%s' argument is of incorrect length", "idLabels"))
767c763
<         stop("'idLabels' can only be a formula or a vector")
---
>         stop(gettextf("'%s' argument can only be a formula or a vector", "idLabels"))
809c805
<     stop("'distance' and 'object' have incompatible lengths")
---
>     stop(gettextf("'%s' and '%s' arguments have incompatible lengths", "distance", "object"))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/nlme.R Recommended/nlme/R/nlme.R
61,63c61,62
<   if (any(!is.na(match(names(thisCall),
< 		       c("fixed", "data", "start"))))) {
<     warning("'nlme.nlsList' will redefine 'fixed', 'data', and 'start'")
---
>   if (any(!is.na(match(names(thisCall), c("fixed", "data", "start"))))) {
>     warning("'nlme.nlsList()' function will redefine 'fixed', 'data', and 'start' arguments")
90c89
<     stop("can only fit \"nlsList\" objects with single grouping variable")
---
>     stop(gettextf("can only fit objects of class %s with single grouping variable", dQuote("nlsList")))
120c119
<       warning("initial value for 'reStruct' overwritten in 'nlme.nlsList'")
---
>       warning(gettextf("initial value for 'reStruct' overwritten in %s function", sQuote("nlme.nlsList()")))
178c177
<     stop("'model' must be a formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "model", dQuote("formula")))
198c197
< 	  stop("incompatible lengths for 'random' and grouping factors")
---
> 	  stop("incompatible lengths for 'random' argument and grouping factors")
201c200
<         for(i in 1:Q) randL[[i]] <- random
---
>         for(i in seq_len(Q)) randL[[i]] <- random
228c227
<       stop("'data' must be given explicitly to use 'nlsList'")
---
>       stop(gettextf("'%s' argument must be given explicitly to use %s function", "data", sQuote("nlsList()")))
262c261
<       stop ("'fixed' must be a formula or list of formulae")
---
>       stop(gettextf("'%s' argument must be a formula or list of formulae", "fixed"))
264c263
<       stop ("formulae in 'fixed' must be of the form \"parameter ~ expr\"")
---
>       stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "fixed"))
266c265
<       stop ("formulae in 'fixed' must be of the form \"parameter ~ expr\"")
---
>       stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "fixed"))
276c275
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
281c280
<         stop ("'random' must be a formula or list of formulae")
---
>         stop(gettextf("'%s' argument must be a formula or list of formulae", "random"))
283c282
<         stop ("formulae in 'random' must be of the form \"parameter ~ expr\"")
---
>         stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "random"))
285c284
<         stop ("formulae in 'random' must be of the form \"parameter ~ expr\"")
---
>         stop(gettextf("formulae in '%s' must be of the form \"parameter ~ expr\"", "random"))
315,316c314,315
<         if (any(corGrpsForm != lmeGrpsForm[1:corQ])) {
<           stop("incompatible formulas for groups in \"random\" and \"correlation\"")
---
>         if (any(corGrpsForm != lmeGrpsForm[seq_len(corQ)])) {
>           stop("incompatible formulas for groups in 'random' and 'correlation' arguments")
319c318
<           warning("cannot use smaller level of grouping for \"correlation\" than for \"random\". Replacing the former with the latter.")
---
>           warning("cannot use smaller level of grouping for 'correlation' than for 'random'. Replacing the former with the latter.")
326,327c325,326
<         if (any(lmeGrpsForm != corGrpsForm[1:lmeQ])) {
<           stop("incompatible formulas for groups in \"random\" and \"correlation\"")
---
>         if (any(lmeGrpsForm != corGrpsForm[seq_len(lmeQ)])) {
>           stop("incompatible formulas for groups in 'random' and 'correlation' arguments")
423c422
<       for(i in 1:Q) {
---
>       for(i in seq_len(Q)) {
512c511
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
541,542c540
<     warning(gettextf("fewer observations than random effects in all level %s groups",
<                      Q), domain = NA)
---
>     warning(gettextf("fewer observations than random effects in all level %s groups", Q), domain = "R-nlme")
559,560c557
<         stop(gettextf("list with starting values for random effects must have names or be of length %d",
<                       Q), domain = NA)
---
>         stop(gettextf("list with starting values for random effects must have names or be of length %d", Q), domain = "R-nlme")
567c564
<                               "group names not matched in starting values for random effects: %s"),
---
>                               "group names not matched in starting values for random effects: %s", domain = "R-nlme"),
572c569
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
581,582c578
<         stop(gettextf("number of rows in starting values for random component at level %s should be %d",
<                       namGrp[i], Dims$ngrps[i]), domain = NA)
---
>         stop(gettextf("number of rows in starting values for random component at level %s should be %d", namGrp[i], Dims$ngrps[i]), domain = "R-nlme")
585,586c581
<         stop(gettextf("number of columns in starting values for random component at level %s should be %d",
<                       namGrp[i], rlength[i]), domain = NA)
---
>         stop(gettextf("number of columns in starting values for random component at level %s should be %d", namGrp[i], rlength[i]), domain = "R-nlme")
594,595c589
<           stop(gettextf("groups levels mismatch in 'random' and starting values for 'random' at level %s",
<                         namGrp[i]), domain = NA)
---
>           stop(gettextf("groups levels mismatch in 'random' and starting values for 'random' at level %s", namGrp[i]), domain = "R-nlme")
613,614c607
<                   stop (gettextf("names mismatch in 'random' and starting values  for 'random' at level %s",
<                                  namGrp[i]), domain = NA)
---
>                   stop (gettextf("names mismatch in 'random' and starting values  for 'random' at level %s", namGrp[i]), domain = "R-nlme")
652c645
<   for(i in 1:Q) {
---
>   for(i in seq_len(Q)) {
719c712
<       for(i in 1:Q) {
---
>       for(i in seq_len(Q)) {
750c743
<   w <- ww[NReal * pLen + (1:NReal)]
---
>   w <- ww[NReal * pLen + seq_len(NReal)]
753c746
<   w <- w + as.vector(ZX[, rLen + (1:fLen), drop = FALSE] %*% sfix)
---
>   w <- w + as.vector(ZX[, rLen + seq_len(fLen), drop = FALSE] %*% sfix)
756,757c749,750
<     for(i in 1:Q) {
<       w <- w + as.vector((ZX[, startRan + 1:ncols[i], drop = FALSE] *
---
>     for(i in seq_len(Q)) {
>       w <- w + as.vector((ZX[, startRan + seq_len(ncols[i]), drop = FALSE] *
826,828c819,821
<       cat("\n**Iteration", numIter)
<       cat(sprintf("\nLME step: Loglik: %s, %s iterations: %d\n",
<                   format(nlmeFit$logLik), controlvals$opt, convIter))
---
>       cat("\n**", gettextf("Iteration %d", numIter, domain = "R-nlme"), sep = "")
>       cat("\n")
>       cat(gettextf("LME step: Loglik: %s, %s iterations: %d", format(nlmeFit$logLik), controlvals$opt, convIter, domain = "R-nlme"), "\n", sep = "")
861c854
<       msg <- "step halving factor reduced below minimum in PNLS step"
---
>       msg <- gettext("step halving factor reduced below minimum in PNLS step", domain = "R-nlme")
879c872
<     for(i in 1:Q) sran[[i]][] <- work$thetaPNLS[(bmap[i]+1):bmap[i+1]]
---
>     for(i in seq_len(Q)) sran[[i]][] <- work$thetaPNLS[(bmap[i]+1):bmap[i+1]]
882,884c875,877
<       cat("PNLS step: RSS = ", format(work$settings[6]), "\n fixed effects: ")
<       for (i in 1:fLen) cat(format(sfix[i])," ")
<       cat("\n iterations:", work$settings[5],"\n")
---
>       cat("\n", gettextf("PNLS step: RSS = %s", format(work$set[6]), domain = "R-nlme"), "\n ", gettext("Fixed effects:", domain = "R-nlme"), sep = "")
>       for (i in seq_len(fLen)) cat(format(sfix[i])," ")
>       cat("\n ", gettext("iterations: ", domain = "R-nlme"), work$settings[5], "\n", sep = "")
887,889c880,882
<     w[] <- work$additional[(NReal * pLen) + 1:NReal]
<     ZX[] <- work$additional[1:(NReal * pLen)]
<     w <- w + as.vector(ZX[, rLen + (1:fLen), drop = FALSE] %*% sfix)
---
>     w[] <- work$additional[(NReal * pLen) + seq_len(NReal)]
>     ZX[] <- work$additional[seq_len(NReal * pLen)]
>     w <- w + as.vector(ZX[, rLen + seq_len(fLen), drop = FALSE] %*% sfix)
891,892c884,885
<     for(i in 1:Q) {
<       w <- w + as.vector((ZX[, startRan + 1:ncols[i], drop = FALSE] *
---
>     for(i in seq_len(Q)) {
>       w <- w + as.vector((ZX[, startRan + seq_len(ncols[i]), drop = FALSE] *
907,908c900,901
<     aConv <- c(fixed = max(conv[1:fLen]))
<     conv <- conv[-(1:fLen)]
---
>     aConv <- c(fixed = max(conv[seq_len(fLen)]))
>     conv <- conv[-seq_len(fLen)]
917,918c910,911
<       cat(sprintf("Convergence crit. (must all become <= tolerance = %g):\n",
<                   controlvals$tolerance))
---
>       cat(gettextf("Convergence crit. (must all become <= tolerance = %g):",
>                   controlvals$tolerance, domain = "R-nlme"), "\n", sep = "")
931c924
< 	controlvals$maxIter)
---
> 	controlvals$maxIter, domain = "R-nlme")
933c926
< 	warning(msg, domain=NA)
---
> 	warning("maximum number of iterations reached without convergence")
936c929
< 	stop(msg, domain=NA)
---
> 	stop("maximum number of iterations reached without convergence")
948c941
<   fixDF <- getFixDF(ZX[, rLen + (1:fLen), drop = FALSE],
---
>   fixDF <- getFixDF(ZX[, rLen + seq_len(fLen), drop = FALSE],
981c974
<       "Approximate variance-covariance matrix not available"
---
>       gettext("Approximate variance-covariance matrix not available", domain = "R-nlme")
1172,1175c1165,1167
<                               "level %s not allowed for %s",
<                               "levels %s not allowed for %s"),
<                      paste(levs[wch], collapse = ",")),
<              domain = NA)
---
>                               "level %s is not allowed for %s",
>                               "levels %s ares not allowed for %s", domain = "R-nlme"),
>                      paste(levs[wch], collapse = ", ")), domain = NA)
1265c1257
<   for(i in 1:nlev) {
---
>   for(i in seq_len(nlev)) {
1299c1291
<     lab <- "Predicted values"
---
>     lab <- gettext("Predicted values", domain = "R-nlme")
1315c1307
<     stop("need an object with call component")
---
>     stop("an object with 'call' component is required")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/nlsList.R Recommended/nlme/R/nlsList.R
33c33
<     stop("second argument must be a groupedData object")
---
>     stop(gettextf("'%s' argument must be an object of class %s", "data", dQuote("groupedData")))
56c56
<     stop("multiple levels not allowed")
---
>     stop("multiple levels are not allowed")
74c74
<       stop("'data' must be a \"groupedData\" object if 'formula' does not include groups")
---
>       stop(gettextf("'%s' argument must be an object of class %s if 'formula' argument does not include groups", "data", dQuote("groupedData")))
90c90
<       stop("old-style self-starting model functions\nare no longer supported.\nNew selfStart functions are available.\nUse\n  SSfpl instead of fpl,\n  SSfol instead of first.order.log,\n  SSbiexp instead of biexp,\n  SSlogis instead of logistic.\nIf writing your own selfStart model, see\n  \"help(selfStart)\"\nfor the new form of the \"initial\" attribute.")
---
>       stop("old-style self-starting model functions\nare no longer supported.\nNew selfStart functions are available.\nUse\n  SSfpl instead of fpl,\n  SSfol instead of first.order.log,\n  SSbiexp instead of biexp,\n  SSlogis instead of logistic.\nIf writing your own selfStart model, see\n  \"help(selfStart)\"\nfor the new form of the \"initial\" attribute.", domain = "R-nlme")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/pdMat.R Recommended/nlme/R/pdMat.R
91c91
< 	warning("ignoring argument 'form'")
---
> 	warning(gettextf("ignoring argument '%s'", "form"))
99c99
< 	warning("ignoring argument 'nam'")
---
> 	warning(gettextf("ignoring argument '%s'", "nam"))
134c134
< 	warning("ignoring argument 'form'")
---
> 	warning(gettextf("ignoring argument '%s'", "form"))
138,139c138
<         stop(gettextf("%s is not a valid object for \"pdMat\"",
<                       sQuote(deparse(object))), domain = NA)
---
>         stop(gettextf("%s is not a valid object for \"pdMat\"", sQuote(deparse(object))), domain = "R-nlme")
172c171
<         stop("'form' can only be a formula or a list of formulae")
---
>         stop(gettextf("'%s' argument can only be a formula or a list of formulae", "form"))
202c201
<           if (err) stop("'form' not consistent with 'nam'")
---
>           if (err) stop(gettextf("'%s' is not consistent with '%s'", "form", "nam"))
210c209
<       stop("length of 'nam' not consistent with dimensions of initial value")
---
>       stop("length of 'nam' is not consistent with dimensions of initial value")
316c315
<             stop(gettextf("Length of names should be %d", aux), domain = NA)
---
>             stop(gettextf("Length of names should be %d", aux), domain = "R-nlme")
323c322
<         stop(gettextf("Length of names should be %d", length(dn)), domain = NA)
---
>         stop(gettextf("Length of names should be %d", length(dn)), domain = "R-nlme")
412c411
< 			 stop("x-y data to splom got botched somehow")
---
> 			 stop("x-y data passed to 'splom()' function got botched somehow")
429c428
<     cat("Positive definite matrix structure of class", class(x)[1], "representing\n")
---
>     cat(gettextf("Positive definite matrix structure of class %s representing", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
432,433c431
<     cat("Uninitialized positive definite matrix structure of class ", class(x)[1],
< 	".\n", sep = "")
---
>     cat(gettextf("Uninitialized positive definite matrix structure of class %s.", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
444c442
<       cat(paste(" Formula: "))
---
>       cat(gettext(" Formula: ", domain = "R-nlme"))
455c453
<           cat("\n Level:", Level)
---
>           cat("\n ", gettext("Level: ", domain = "R-nlme"), Level, sep = "")
470c468
<       cat(paste(" Structure: ", attr(x, "structName"), "\n", sep = ""))
---
>       cat(gettext(" Structure: ", domain = "R-nlme"), attr(x, "structName"), "\n", sep = "")
504c502
<     cat(paste(" Composite Structure: ", attr(x, "structName"), "\n", sep =""))
---
>     cat(gettext(" Composite Structure: ", domain = "R-nlme"), attr(x, "structName"), "\n", sep ="")
606,607c604
<       stop(gettextf("an object of length %d does not match the required parameter size",
<                     length(val)), domain = NA)
---
>       stop(gettextf("an object of length %d does not match the required parameter size", length(val)), domain = "R-nlme")
730,731c727
<       stop(gettextf("an object of length %d does not match a Cholesky factor",
<                     length(val)), domain = NA)
---
>       stop(gettextf("an object of length %d does not match a Cholesky factor", length(val)), domain = "R-nlme")
1034c1030
< #    for(i in 1:(q-1)) {
---
> #    for(i in seq_len(q-1)) {
1136,1137c1132
<       stop(gettextf("an object of length %d does not match the required parameter size",
<                     length(val)), domain = NA)
---
>       stop(gettextf("an object of length %d does not match the required parameter size", length(val)), domain = "R-nlme")
1298,1299c1293
<         stop(gettextf("an object of length %d does not match the required parameter size",
<                       length(val)), domain = NA)
---
>         stop(gettextf("an object of length %d does not match the required parameter size", length(val)), domain = "R-nlme")
1315c1309
<     stop("cannot extract the matrix from an uninitialized object")
---
>     stop(gettextf("cannot extract the matrix from an uninitialized object of class %s", dQuote("pdDiag")))
1399c1393
<     stop("cannot extract the matrix from an uninitialized \"pdIdent\" object")
---
>     stop(gettextf("cannot extract the matrix from an uninitialized object of class %s", dQuote("pdIdent")))
1439,1440c1433
<       stop(gettextf("an object of length %d does not match the required parameter size",
<                     length(val)), domain = NA)
---
>       stop(gettextf("an object of length %d does not match the required parameter size", length(val)), domain = "R-nlme")
1443c1436
<     stop("must give names when initializing \"pdIdent\" from parameter without a formula")
---
>     stop(gettextf("must give names when initializing %s from parameter without a formula", dQuote("pdIdent")))
1461c1454
<     stop("cannot extract the matrix from an uninitialized \"pdIdent\" object")
---
>     stop(gettextf("cannot extract the matrix from an uninitialized object of class %s", dQuote("pdIdent")))
1538c1531
<     stop("cannot extract the matrix from an uninitialized \"pdCompSymm\" object")
---
>     stop(gettextf("cannot extract the matrix from an uninitialized object of class %s", dQuote("pdCompSymm")))
1590,1591c1583
<       stop(gettextf("an object of length %d does not match the required parameter size",
<                     length(val)), domain = NA)
---
>       stop(gettextf("an object of length %d does not match the required parameter size", length(val)), domain = "R-nlme")
1594c1586
<     stop("must give names when initializing \"pdCompSymm\" from parameter without a formula")
---
>     stop(gettextf("must give names when initializing %s from parameter without a formula", dQuote("pdCompSymm")))
1615c1607
<     stop("cannot extract the matrix from an uninitialized \"pdCompSymm\" object")
---
>     stop(gettextf("cannot extract the matrix from an uninitialized object of class %s", dQuote("pdCompSymm")))
1738c1730
<       stop("'form' must be a list")
---
>       stop(gettextf("'%s' argument must be a list", "form"))
1747c1739
<       stop("'nam' must be a list")
---
>       stop(gettextf("'%s' argument must be a list", "nam"))
1751c1743
<       stop("'form' and 'nam' have incompatible lengths")
---
>       stop(gettextf("'%s' and '%s' arguments have incompatible lengths", "form", "nam"))
1759c1751
<       stop("'pdClass' must be a character vector")
---
>       stop(gettextf("'%s' argument must be a character vector", "pdClass"))
1764c1756
< 	stop("'form' and 'pdClass' have incompatible lengths")
---
>         stop(gettextf("'%s' and '%s' arguments have incompatible lengths", "form", "pdClass"))
1767c1759
< 	stop("'nam' and 'pdClass' have incompatible lengths")
---
>         stop(gettextf("'%s' and '%s' arguments have incompatible lengths", "nam", "pdClass"))
1800c1792
<   for(i in 1:nB) {
---
>   for(i in seq_len(nB)) {
1861c1853
<     stop("all elements in the argument must generate \"pdMat\" objects")
---
>     stop(gettextf("all elements in the argument must generate objects of class %s", dQuote("pdMat")))
1873c1865
<       for(i in 1:nB) {
---
>       for(i in seq_len(nB)) {
1971c1963
<     stop("cannot change parameter length of initialized \"pdMat\" object")
---
>     stop(gettextf("cannot change parameter length of initialized object of class %s", dQuote("pdMat")))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/reStruct.R Recommended/nlme/R/reStruct.R
67c67
<       stop("\"pdMat\" element must have a formula")
---
>       stop(gettextf("'%s' argument must have a formula", "object"))
72c72
<       stop("'object' must be a list or a formula")
---
>       stop(gettextf("'%s' argument must be a list or a formula", "object"))
85c85
<                              stop("\"pdMat\" elements must have a formula")
---
>                              stop(gettextf("'%s' argument must have a formula", "object"))
102c102
<                  stop("elements in 'object' must be formulas or \"pdMat\" objects")
---
>                  stop("elements in 'object' argument must be formulae or objects of class \"pdMat\"")
190c190
<     stop("cannot change the parameter when ength of parameters is undefined")
---
>     stop("cannot change the parameter when length of parameters is undefined")
193c193
<     stop("cannot change parameter length of initialized objects")
---
>     stop(gettextf("cannot change parameter length of initialized object of class %s", dQuote("reStruct")))
254c254
<     stop("all elements of a \"reStruct\" object must have a non-zero size")
---
>     stop(gettextf("all elements of an object of class %s must have a non-zero size", dQuote("reStruct")))
266c266
< 	     2, sum)/ rep(dims$ngrps[1:Q], qvec), rep(1:Q, qvec)),
---
> 	     2, sum)/ rep(dims$ngrps[seq_len(Q)], qvec), rep(1:Q, qvec)),
312c312
<     stop("cannot change the length of 'object'")
---
>     stop("cannot change the length of 'object' argument")
405c405
<     cat("Random effects:\n")
---
>     cat(gettext("Random effects:", domain = "R-nlme"), "\n", sep = "")
410c410
< 	cat("Random effects estimates:\n")
---
> 	cat(gettext("Random effects estimates:", domain = "R-nlme"), "\n", sep = "")
416c416
<     cat("Uninitialized random effects structure\n")
---
>     cat(gettext("Uninitialized random effects structure", domain = "R-nlme"), "\n", sep = "")
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/simulate.R Recommended/nlme/R/simulate.R
26c26
<         stop("\nfixed-effects model must be a formula of the form \"resp ~ pred\"")
---
>         stop("fixed-effects model must be a formula of the form \"resp ~ pred\"")
38c38
<                     stop("incompatible lengths for 'random' and grouping factors")
---
>                     stop("incompatible lengths for 'random' argument and grouping factors")
118c118
<              domain = NA)
---
>              domain = "R-nlme")
188c188
<     qvec <- nullD$qvec[1:Q]
---
>     qvec <- nullD$qvec[seq_len(Q)]
196c196
<     ind <- lapply(1:Q, function(i) rep(1:ngrp[i], nullD$ZXlen[[i]]))
---
>     ind <- lapply(seq_len(Q), function(i) rep(seq_len(ngrp[i]), nullD$ZXlen[[i]]))
198c198
<         nML   <- array(0, c(nsim, 2), list(1:nsim, c("info", "logLik")))
---
>         nML   <- array(0, c(nsim, 2), list(seq_len(nsim), c("info", "logLik")))
200c200
<         nREML <- array(0, c(nsim, 2), list(1:nsim, c("info", "logLik")))
---
>         nREML <- array(0, c(nsim, 2), list(seq_len(nsim), c("info", "logLik")))
230c230
<         ssq2 <- sum((altD$qvec[1:altD$Q])^2)
---
>         ssq2 <- sum((altD$qvec[seq_len(altD$Q)])^2)
239c239
<     for(i in 1:nsim) {
---
>     for(i in seq_len(nsim)) {
242c242
<         for(j in 1:Q) {
---
>         for(j in seq_len(Q)) {
245c245
<                         list(1:ngrp[j], NULL)) %*% DeltaInv[[j]])[ind[[j]], , drop = FALSE] *
---
>                         list(seq_len(ngrp[j]), NULL)) %*% DeltaInv[[j]])[ind[[j]], , drop = FALSE] *
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/varFunc.R Recommended/nlme/R/varFunc.R
81,82c81
<       stop(gettextf("do not know how to get coefficients for %s object",
<                     dQuote(class(object)[1])), domain = NA)
---
>       stop(gettextf("do not know how to get coefficients for %s object", dQuote(class(object)[1])), domain = "R-nlme")
136,139c135,138
<     if (header) cat("Variance function:\n")
<     cat(paste(" Structure: ", attr(x, "structName"), "\n", sep = ""))
<     cat(paste(" Formula:", deparse(formula(x)),"\n"))
<     cat(" Parameter estimates:\n")
---
>     if (header) cat(gettext("Variance function:", domain = "R-nlme"), "\n", sep = "")
>     cat(gettext(" Structure: ", domain = "R-nlme"), attr(x, "structName"), "\n", sep = "")
>     cat(gettext(" Formula: ", domain = "R-nlme"), deparse(formula(x)), "\n", sep = "")
>     cat(gettext(" Parameter estimates:", domain = "R-nlme"), "\n", sep = "")
146,147c145
<     cat("Variance function structure of class", class(x)[1],
< 	"with no parameters, or uninitialized\n")
---
>     cat(gettextf("Variance function structure of class %s with no parameters, or uninitialized", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
156,157c154
<     cat("Variance function structure of class", class(x)[1],
< 	"representing\n")
---
>     cat(gettextf("Variance function structure of class %s representing", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
160,161c157
<     cat("Variance function structure of class", class(x)[1],
< 	"with no parameters, or uninitialized\n")
---
>     cat(gettextf("Variance function structure of class %s with no parameters, or uninitialized", dQuote(class(x)[1]), domain = "R-nlme"), "\n", sep = "")
203c199
<     stop("'value' must be a one sided formula")
---
>     stop(gettextf("'%s' argument is not an object of class %s", "value", dQuote("formula")))
207c203
<     stop("'form' must have a covariate")
---
>     stop(gettextf("'%s' argument must have a covariate", "value"))
211c207
<     warning("ignoring 'group' in \"varFixed\" formula")
---
>     warning("ignoring group in 'varFixed()' function")
233c229
<     stop("all variables used in 'formula' must be in 'data'")
---
>     stop("all variables used in 'object' argument must be in 'data' argument")
245,247c241,243
<   cat("Variance function:\n")
<   cat(" Structure: fixed weights\n")
<   cat(paste(" Formula:", deparse(formula(x)),"\n"))
---
>   cat(gettext("Variance function:", domain = "R-nlme"), "\n", sep = "")
>   cat(gettext(" Structure: fixed weights", domain = "R-nlme"), "\n", sep = "")
>   cat(gettext(" Formula: ", domain = "R-nlme"), deparse(formula(x)), "\n", sep = "")
271c267
< 	stop("initial values must have group names in 'varIdent'")
---
> 	stop(gettextf("initial values must have group names in %s function", sQuote("varIdent()")))
275c271
< 	stop("initial values for 'varIdent' must be > 0")
---
> 	stop("initial values for 'varIdent()' function must be > 0")
283c279
< 	stop("fixed parameters must have names in 'varIdent'")
---
> 	stop("fixed parameters must have names in 'varIdent()' function")
340c336
<       stop("cannot change the length of the \"varIdent\" parameter after initialization")
---
>       stop(gettextf("cannot change the length of the %s parameter after initialization", dQuote("varIdent")))
369c365
< 	stop("fixed parameter names in 'varIdent' must be a subset of group names")
---
> 	stop("fixed parameter names in 'varIdent()' function must be a subset of group names")
392,393c388
<             stop(gettextf("initial value for \"varIdent\" should be of length %d",
<                           len), domain = NA)
---
>             stop(gettextf("initial value for %s should be of length %d", dQuote("varIdent"), len), domain = "R-nlme")
398c393
< 	    stop("names of starting value for \"varIdent\" object must contain all but one of the stratum levels")
---
> 	    stop("names of starting value for object of class \"varIdent\" must contain all but one of the stratum levels")
403c398
< 	    stop("nonexistent group names for initial values in 'varIdent'")
---
> 	    stop(gettextf("nonexistent group names for initial values in %s function", sQuote("varIdent()")))
450,451c445,446
< 	   structName = if (is.null(formula(object))) "Constant variance"
< 	                else "Different standard deviations per stratum",
---
> 	   structName = if (is.null(formula(object))) gettext("Constant variance", domain = "R-nlme")
> 	                else gettext("Different standard deviations per stratum", domain = "R-nlme"),
469c464
<     stop("'form' must have a covariate")
---
>     stop(gettextf("'%s' argument must have a covariate", "form"))
473c468
<       stop("initial values must have group names in 'varPower'")
---
>       stop(gettextf("initial values must have group names in %s function", sQuote("varPower()")))
477c472
< 	stop("fixed parameters must have group names in 'varPower'")
---
> 	stop(gettextf("fixed parameters must have group names in %s function", sQuote("varPower()")))
524c519
<       stop("cannot change the length of the \"varStruct\" parameter after initialization")
---
>       stop(gettextf("cannot change the length of the %s parameter after initialization", dQuote("varStruct")))
562c557
< 	  stop("fixed parameters must have group names")
---
> 	  stop(gettextf("fixed parameters must have group names in %s function", sQuote("Initialize.varPower()")))
588,589c583
<               stop(gettextf("initial value for \"varPower\" should be of length %d",
<                             nStratVar), domain = NA)
---
>               stop(gettextf("initial value for %s should be of length %d", dQuote("varPower"), nStratVar), domain = "R-nlme")
594c588
< 	    stop("nonexistent group names for initial values in \"varPower\"")
---
> 	    stop(gettextf("nonexistent group names for initial values in %s function", sQuote("varPower()")))
631c625
<         stop("initial value for \"varPower\" should be of length 1")
---
>         stop(gettextf("initial value for %s should be of length %d", dQuote("varPower"), 1), domain = "R-nlme")
649c643
<   function(object, structName = "Power of variance covariate", ...)
---
>   function(object, structName = gettext("Power of variance covariate", domain = "R-nlme"), ...)
683c677
<     stop("'form' must have a covariate")
---
>     stop(gettextf("'%s' argument must have a covariate", "form"))
687c681
<       stop("initial values must have group names in 'varExp'")
---
>       stop(gettextf("initial values must have group names in %s function", sQuote("varExp()")))
691c685
< 	stop("fixed parameters must have group names in 'varExp'")
---
> 	stop(gettextf("fixed parameters must have group names in %s function", sQuote("varExp()")))
737c731
<       stop("cannot change the length of the \"varExp\" parameter after initialization")
---
>       stop(gettextf("cannot change the length of the %s parameter after initialization", dQuote("varExp")))
773c767
< 	  stop("fixed parameters must have group names")
---
> 	   stop(gettextf("fixed parameters must have group names in %s function", sQuote("Initialize.varExp()")))
799,800c793
<               stop(gettextf("initial value for \"varExp\" should be of length %d",
<                             nStratVar), domain = NA)
---
>               stop(gettextf("initial value for %s should be of length %d", dQuote("varExp"), nStratVar), domain = "R-nlme")
805c798
< 	    stop("nonexistent group names for initial values in \"varExp\"")
---
> 	    stop(gettextf("nonexistent group names for initial values in %s function", sQuote("varExp()")))
842c835
<         stop("initial value for \"varExp\" should be of length 1")
---
>         stop(gettextf("initial value for %s should be of length %d", dQuote("varExp"), 1), domain = "R-nlme")
897c890
<       stop(gettextf("%s can have at most two components", nam), domain = NA)
---
>       stop(gettextf("%s can have at most two components", nam), domain = "R-nlme")
903,904c896
<         stop(gettextf("%s can only have names \"const\" and \"power\"", nam),
<              domain = NA)
---
>         stop(gettextf("%s can only have names \"const\" and \"power\"", nam), domain = "R-nlme")
913c905
<         stop(gettextf("%s can only be a list or numeric", nam), domain = NA)
---
>         stop(gettextf("%s can only be a list or numeric", nam), domain = "R-nlme")
923,924c915
<         stop(gettextf("%s must have group names in 'varConstPower'", nam),
<              domain = NA)
---
>         stop(gettextf("%s must have group names in 'varConstPower'", nam), domain = "R-nlme")
939c930
<     stop("'form' must have a covariate")
---
>     stop(gettextf("'%s' argument must have a covariate", "form"))
1054c1045
< 	    stop("fixed parameters must have group names")
---
> 	     stop(gettextf("fixed parameters must have group names in %s function", sQuote("Initialize.varConstPower()")))
1079,1080c1070
<                 stop(gettext("initial value should be of length %d",
<                              nStratVar), domain = NA)
---
>                 stop(gettext("initial value should be of length %d", nStratVar), domain = "R-nlme")
1085c1075
< 	      stop("nonexistent group names for initial values")
---
> 	      stop(gettextf("nonexistent group names for initial values in %s function", sQuote("varConstPower()")))
1128c1118
<       stop(gettext("initial value should be of length %d", aux), domain = NA)
---
>       stop(gettext("initial value should be of length %d", aux), domain = "R-nlme")
1134c1124
<   function(object, structName = "Constant plus power of variance covariate",
---
>   function(object, structName = gettext("Constant plus power of variance covariate"),
1169c1159
<     stop("all arguments to 'varComb' must be of class \"varFunc\".")
---
>     stop("all arguments passed to 'varComb()' function must be of class \"varFunc\"")
1201c1191
<       stop("cannot change parameter length of initialized \"varComb\" object")
---
>       stop(gettextf("cannot change parameter length of initialized object of class %s", dQuote("varComb")))
1242c1232
<   cat("Combination of:\n")
---
>   cat(gettext("Combination of:", domain = "R-nlme"), "\n", sep = "")
1256c1246
<   function(object, structName = "Combination of variance functions:", ...)
---
>   function(object, structName = gettext("Combination of variance functions:", domain = "R-nlme"), ...)
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/R/zzMethods.R Recommended/nlme/R/zzMethods.R
37,39c37,38
< 	    warning("Package ", dQuote(pkgname), " installed with old R version ",
< 		    built.R.ver, " should not be used with R version ", getRversion(),
< 		    "\n  Rather re-install it with this version of R.")
---
> 	    warning(gettextf("Package %s installed with old R version %s should not be used with R version %s\n  Rather re-install it with this version of R.", dQuote(pkgname),
> 		    built.R.ver, getRversion(), domain = "R-nlme"))
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/src/base.h Recommended/nlme/src/base.h
33,38d32
< #ifdef ENABLE_NLS
< # include <libintl.h>
< # define _(String) dgettext ("nlme", String)
< #else
< # define _(String) (String)
< #endif
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/src/corStruct.c Recommended/nlme/src/corStruct.c
28c28
< 
---
> #include "localization.h"
Only in Recommended/nlme/src: localization.h
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/src/nlme.c Recommended/nlme/src/nlme.c
28a29
> #include "localization.h"
diff -rEZbwB '--exclude=*.[lo,d,pdf,mo,po,tgz,gz,save]*' '--exclude=MD5' '--exclude=Makefile*' '--exclude=all.R' '--exclude=Changes' R-recommended/nlme/src/nlmefit.c Recommended/nlme/src/nlmefit.c
28a29
> #include "localization.h"
368c369
< 		warning("Singular precision matrix in level %ld, block %ld",
---
> 		warning(_("Singular precision matrix in level %ld, block %ld"),
